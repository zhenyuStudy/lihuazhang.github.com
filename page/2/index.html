<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>八点下班</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta property="og:type" content="website">
<meta property="og:title" content="八点下班">
<meta property="og:url" content="http://8atmyhouse.com/page/2/index.html">
<meta property="og:site_name" content="八点下班">
<meta property="og:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八点下班">
<meta name="twitter:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
  
    <link rel="alternative" href="/atom.xml" title="八点下班" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">恒温</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/about/">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/metro/" style="font-size: 10px;">Metro</a> <a href="/tags/capybara/" style="font-size: 17.5px;">capybara</a> <a href="/tags/cucumber/" style="font-size: 15px;">cucumber</a> <a href="/tags/factory-gril/" style="font-size: 10px;">factory_gril</a> <a href="/tags/git/" style="font-size: 12.5px;">git</a> <a href="/tags/nexus-7-2013/" style="font-size: 10px;">nexus 7 2013</a> <a href="/tags/pageobject/" style="font-size: 12.5px;">pageobject</a> <a href="/tags/test-china-org/" style="font-size: 20px;">test-china.org</a> <a href="/tags/vim/" style="font-size: 12.5px;">vim</a> <a href="/tags/xpath/" style="font-size: 10px;">xpath</a> <a href="/tags/性能测试/" style="font-size: 10px;">性能测试</a> <a href="/tags/游戏开发/" style="font-size: 10px;">游戏开发</a> <a href="/tags/翻译/" style="font-size: 10px;">翻译</a> <a href="/tags/陆犯焉识/" style="font-size: 10px;">陆犯焉识</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">专注于前端</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">恒温</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">恒温</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/about/">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2013-08-12-install-vim74-from-source" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-08-12-install-vim74-from-source/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-08-12-install-vim74-from-source/">Install vim74 from source</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Vim_7-4_released_21"><a href="#Vim_7-4_released_21" class="headerlink" title="Vim 7.4 released!"></a>Vim 7.4 released!</h2><p><img src="http://www.vim.org/images/vim_drill_small.JPG" alt=""></p>
<p>What are you waiting for?</p>
<hr>
<h3 id="install_vim7-4_for_mac"><a href="#install_vim7-4_for_mac" class="headerlink" title="install vim7.4 for mac"></a>install vim7.4 for mac</h3><p>HomeBrew has update the vim formula to the latest 7.4! woo!</p>
<p>See <a href="https://raw.github.com/mxcl/homebrew/master/Library/Formula/vim.rb" target="_blank" rel="external">vim.rb</a></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'formula'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vim</span> <span class="inheritance">&lt; <span class="parent">Formula</span></span></span></span><br><span class="line">  homepage <span class="string">'http://www.vim.org/'</span></span><br><span class="line">  <span class="comment"># Get the base 7.4 tarball from Vim.org. But once patches start again, go</span></span><br><span class="line">  <span class="comment"># back to tracking Debian unstable here:</span></span><br><span class="line">  <span class="comment"># http://ftp.de.debian.org/debian/pool/main/v/vim/</span></span><br><span class="line">  url <span class="string">'http://ftp.vim.org/pub/vim/unix/vim-7.4.tar.bz2'</span></span><br><span class="line">  sha1 <span class="string">'601abf7cc2b5ab186f40d8790e542f86afca86b7'</span></span><br><span class="line"></span><br><span class="line">  head <span class="string">'https://vim.googlecode.com/hg/'</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># We only have special support for finding depends_on :python, but not yet for</span></span><br><span class="line">  <span class="comment"># :ruby, :perl etc., so we use the standard environment that leaves the</span></span><br><span class="line">  <span class="comment"># PATH as the user has set it right now.</span></span><br><span class="line">  env <span class="symbol">:std</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">LANGUAGES</span>         = <span class="string">%w(lua mzscheme perl python tcl ruby)</span></span><br><span class="line">  <span class="constant">DEFAULT_LANGUAGES</span> = <span class="string">%w(ruby python)</span></span><br><span class="line"></span><br><span class="line">  option <span class="string">"override-system-vi"</span>, <span class="string">"Override system vi"</span></span><br><span class="line">  option <span class="string">"disable-nls"</span>, <span class="string">"Build vim without National Language Support (translated messages, keymaps)"</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">LANGUAGES</span>.each <span class="keyword">do</span> |language|</span><br><span class="line">    option <span class="string">"with-<span class="subst">#&#123;language&#125;</span>"</span>, <span class="string">"Build vim with <span class="subst">#&#123;language&#125;</span> support"</span></span><br><span class="line">    option <span class="string">"without-<span class="subst">#&#123;language&#125;</span>"</span>, <span class="string">"Build vim without <span class="subst">#&#123;language&#125;</span> support"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  depends_on <span class="symbol">:hg</span> =&gt; <span class="symbol">:build</span> <span class="keyword">if</span> build.head?</span><br><span class="line">  depends_on <span class="symbol">:python</span> =&gt; <span class="symbol">:recommended</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">install</span></span></span><br><span class="line">    <span class="constant">ENV</span>[<span class="string">'LUA_PREFIX'</span>] = <span class="constant">HOMEBREW_PREFIX</span></span><br><span class="line"></span><br><span class="line">    language_opts = <span class="constant">LANGUAGES</span>.map <span class="keyword">do</span> |language|</span><br><span class="line">      <span class="keyword">if</span> <span class="constant">DEFAULT_LANGUAGES</span>.<span class="keyword">include</span>? language <span class="keyword">and</span> !build.<span class="keyword">include</span>? <span class="string">"without-<span class="subst">#&#123;language&#125;</span>"</span></span><br><span class="line">        <span class="string">"--enable-<span class="subst">#&#123;language&#125;</span>interp"</span></span><br><span class="line">      <span class="keyword">elsif</span> build.<span class="keyword">include</span>? <span class="string">"with-<span class="subst">#&#123;language&#125;</span>"</span></span><br><span class="line">        <span class="string">"--enable-<span class="subst">#&#123;language&#125;</span>interp"</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>.compact</span><br><span class="line"></span><br><span class="line">    opts = language_opts</span><br><span class="line">    opts &lt;&lt; <span class="string">"--disable-nls"</span> <span class="keyword">if</span> build.<span class="keyword">include</span>? <span class="string">"disable-nls"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Avoid that vim always links System's Python even if configure tells us</span></span><br><span class="line">    <span class="comment"># it has found a brewed Python. Verify with `otool -L`.</span></span><br><span class="line">    <span class="keyword">if</span> python &amp;&amp; python.brewed?</span><br><span class="line">      <span class="constant">ENV</span>.prepend <span class="string">'LDFLAGS'</span>, <span class="string">"-F<span class="subst">#&#123;python.framework&#125;</span>"</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># <span class="doctag">XXX:</span> Please do not submit a pull request that hardcodes the path</span></span><br><span class="line">    <span class="comment"># to ruby: vim can be compiled against 1.8.x or 1.9.3-p385 and up.</span></span><br><span class="line">    <span class="comment"># If you have problems with vim because of ruby, ensure a compatible</span></span><br><span class="line">    <span class="comment"># version is first in your PATH when building vim.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># We specify HOMEBREW_PREFIX as the prefix to make vim look in the</span></span><br><span class="line">    <span class="comment"># the right place (HOMEBREW_PREFIX/share/vim/&#123;vimrc,vimfiles&#125;) for</span></span><br><span class="line">    <span class="comment"># system vimscript files. We specify the normal installation prefix</span></span><br><span class="line">    <span class="comment"># when calling "make install".</span></span><br><span class="line">    system <span class="string">"./configure"</span>, <span class="string">"--prefix=<span class="subst">#&#123;<span class="constant">HOMEBREW_PREFIX</span>&#125;</span>"</span>,</span><br><span class="line">                          <span class="string">"--mandir=<span class="subst">#&#123;man&#125;</span>"</span>,</span><br><span class="line">                          <span class="string">"--enable-gui=no"</span>,</span><br><span class="line">                          <span class="string">"--without-x"</span>,</span><br><span class="line">                          <span class="string">"--enable-multibyte"</span>,</span><br><span class="line">                          <span class="string">"--with-tlib=ncurses"</span>,</span><br><span class="line">                          <span class="string">"--enable-cscope"</span>,</span><br><span class="line">                          <span class="string">"--with-features=huge"</span>,</span><br><span class="line">                          <span class="string">"--with-compiledby=Homebrew"</span>,</span><br><span class="line">                          *opts</span><br><span class="line">    system <span class="string">"make"</span></span><br><span class="line">    <span class="comment"># If stripping the binaries is not enabled, vim will segfault with</span></span><br><span class="line">    <span class="comment"># statically-linked interpreters like ruby</span></span><br><span class="line">    <span class="comment"># http://code.google.com/p/vim/issues/detail?id=114&amp;thanks=114&amp;ts=1361483471</span></span><br><span class="line">    system <span class="string">"make"</span>, <span class="string">"install"</span>, <span class="string">"prefix=<span class="subst">#&#123;prefix&#125;</span>"</span>, <span class="string">"STRIP=/usr/bin/true"</span></span><br><span class="line">    ln_s bin+<span class="string">'vim'</span>, bin+<span class="string">'vi'</span> <span class="keyword">if</span> build.<span class="keyword">include</span>? <span class="string">'override-system-vi'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Just use</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install vim --with-python --with-ruby --with-perl --with-lua --with-tcl</span><br></pre></td></tr></table></figure>
<p>Wait or take a coffee break! And enjoy vim 7.4.</p>
<p>By the way, when you want to update brew but failed because of some formula you’ve editted which results in merge…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> `brew --prefix`</span><br><span class="line">git checkout .</span><br><span class="line">brew update</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="install_vim7-4_for_ubuntu"><a href="#install_vim7-4_for_ubuntu" class="headerlink" title="install vim7.4 for ubuntu"></a>install vim7.4 for ubuntu</h3><p>A little complex but very easy!</p>
<ul>
<li>install the dependencies</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libncurses5-dev libgnome2-dev libgnomeui-dev \</span><br><span class="line">libgtk2.<span class="number">0</span>-dev libatk1.<span class="number">0</span>-dev libbonoboui2-dev \</span><br><span class="line">libcairo2-dev libx11-dev libxpm-dev libxt-dev python-dev ruby-dev libperl-dev</span><br></pre></td></tr></table></figure>
<p>Note. I’m not very clear about the dependencies but <code>python-dev</code> <code>ruby-dev</code> <code>libperl-dev</code> are for python, ruby, perl interp.<br>For me, that’s enough.</p>
<ul>
<li>remove the old vim</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove vim vim-runtime gvim  vim-tiny vim-common vim-gui-common</span><br></pre></td></tr></table></figure>
<ul>
<li>download the source and compile to install</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">wget http://ftp.vim.org/pub/vim/unix/vim-<span class="number">7.4</span>.tar.bz2</span><br><span class="line">tar xvf vim-<span class="number">7.4</span>.tar.bz2</span><br><span class="line"><span class="built_in">cd</span> vim</span><br><span class="line"></span><br><span class="line">./configure \</span><br><span class="line">    --prefix=/usr \</span><br><span class="line">    --enable-perlinterp=dynamic \</span><br><span class="line">    --enable-pythoninterp \</span><br><span class="line">    --enable-rubyinterp \</span><br><span class="line">    --enable-luainterp=dynamic \</span><br><span class="line">    --enable-cscope \</span><br><span class="line">    --enable-gui=auto \</span><br><span class="line">    --enable-gtk2-check \</span><br><span class="line">    --enable-gnome-check \</span><br><span class="line">    --enable-multibyte \</span><br><span class="line">    --enable-fontset \</span><br><span class="line">    --with-features=huge \</span><br><span class="line">    --with-x \</span><br><span class="line">    --with-ruby-command=/usr/bin/ruby \</span><br><span class="line">    --with-compiledby=<span class="string">"Lihuazhang &lt;lihuazhang@hotmail.com&gt;"</span> \</span><br><span class="line">    --with-python-config-dir=/usr/lib/python2.<span class="number">7</span>/config-x86_64-linux-gnu \</span><br><span class="line"></span><br><span class="line"><span class="comment"># --with-python3-config-dir=/usr/lib/python3.3/config-3.3m-x86_64-linux-gnu</span></span><br></pre></td></tr></table></figure>
<p>Wait for a seconds and <code>sudo make install</code> once the configure is compelted.</p>
<ul>
<li>set your vim  as your default editor</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The prefix=/usr should be specified!</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/editor editor /usr/bin/vim <span class="number">1</span></span><br><span class="line">sudo update-alternatives --set editor /usr/bin/vim</span><br><span class="line">sudo update-alternatives --install /usr/bin/vi vi /usr/bin/vim <span class="number">1</span></span><br><span class="line">sudo update-alternatives --set vi /usr/bin/vim</span><br></pre></td></tr></table></figure>
<p>Then done. Enjoy vim7.4.</p>
<hr>
<p>I have personally tested both installation.</p>
<p>If you have any question, please ping me. Or</p>
<p>Refer:</p>
<ol>
<li><a href="http://vim.wikia.com/wiki/Building_Vim" target="_blank" rel="external">http://vim.wikia.com/wiki/Building_Vim</a></li>
<li><a href="https://github.com/Valloric/YouCompleteMe/wiki/Building-Vim-from-source" target="_blank" rel="external">https://github.com/Valloric/YouCompleteMe/wiki/Building-Vim-from-source</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/vim/">vim</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-08-08-cucumberhe-capybaraxia-de-pageobject" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-08-08-cucumberhe-capybaraxia-de-pageobject/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-08-08-cucumberhe-capybaraxia-de-pageobject/">Cucumber 和 Capybara 下的 PageObject</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>接上篇 <a href="/blog/step-defintionshi-kong.html">由 step definition 失控引发的讨论和思考</a>。</p>
<h2 id="PageObject"><a href="#PageObject" class="headerlink" title="PageObject"></a>PageObject</h2><p>先来看下目录结构</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── Gemfile</span><br><span class="line">├── Gemfile.lock</span><br><span class="line">├── README</span><br><span class="line">├── Rakefile</span><br><span class="line">├── cucumber.yml</span><br><span class="line">├── features</span><br><span class="line">│   ├── example</span><br><span class="line">│   │   ├── example.feature</span><br><span class="line">│   │   ├── step_definitions</span><br><span class="line">│   │   │   └── example_steps.rb</span><br><span class="line">│   │   └── support</span><br><span class="line">│   │       └── env.rb</span><br><span class="line">│   └── blog_project</span><br><span class="line">│       ├── user_management</span><br><span class="line">|<span class="string">       </span>|<span class="string">     </span>|<span class="string">---  login.feature</span><br><span class="line"></span>|<span class="string">       </span>|<span class="string">     </span>|<span class="string">---  logout.feature</span><br><span class="line">│       ├── post_management</span><br><span class="line"></span>|<span class="string">       </span>|<span class="string">     </span>|<span class="string">---  write_a_post.feature</span><br><span class="line">│       ├── upload_image.feature</span><br><span class="line">│       ├── pages</span><br><span class="line">│       │   ├── login_page.rb</span><br><span class="line">│       │   └── post_page.rb</span><br><span class="line">│       ├── step_definitions</span><br><span class="line">│       │   ├── post_step.rb</span><br><span class="line">│       │   ├── user_step.rb</span><br><span class="line">│       │   ├── common_steps.rb</span><br><span class="line">│       └── support</span><br><span class="line">│           ├── env.rb</span><br><span class="line">│           └── helper</span><br><span class="line">│               └── path.rb</span><br><span class="line">└── features_report.html</span></span><br></pre></td></tr></table></figure>
<ol>
<li>把 features 按照模块用目录分类。</li>
<li>将 page object 放在 pages 目录下。</li>
<li>每一个模块一个 step definition rb 文件。</li>
<li>在 support 里配置各种环境啊，hook啊，帮助类等。</li>
</ol>
<p>其实无论你怎么写， cucumber 运行的时候，都会把这些 rb 一股脑儿加载进来。所以对于<br>cucumber 来说什么样子的目录结构对它无所谓，所以对我们而言，只要方便管理就可以了。</p>
<p>现在我们就要在 pages 这个目录做文章。在 cucumber 下使用 pageobject 一般有两种方法：</p>
<h3 id="1-__u81EA_u5DF1_u5C01_u88C5"><a href="#1-__u81EA_u5DF1_u5C01_u88C5" class="headerlink" title="1. 自己封装"></a>1. 自己封装</h3><p><em>自己封装 pageobject 的过程其实就是把 webdriver page object java 的那一套翻译成  ruby。</em></p>
<ul>
<li>提取页面元素</li>
<li>封装页面业务逻辑</li>
</ul>
<p>比如：</p>
<p>login_page.rb</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span></span></span><br><span class="line"></span><br><span class="line">  <span class="constant">URL</span> = <span class="string">"/login"</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(session)</span></span></span><br><span class="line">    <span class="variable">@session</span> = session</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">visit</span></span></span><br><span class="line">    <span class="variable">@session</span>.visit <span class="constant">URL</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">username_input_element</span></span></span><br><span class="line">    <span class="variable">@session</span>.find <span class="string">"input[name=username]"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">password_input_element</span></span></span><br><span class="line">    <span class="variable">@session</span>.find <span class="string">"input[name=password]"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">login</span> <span class="title">name</span>, <span class="title">password</span></span></span><br><span class="line">    username_input_element.type name</span><br><span class="line">    password_input_element.type password</span><br><span class="line">    <span class="variable">@session</span>.click_button(<span class="string">"login"</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>login_stepdef.rb</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Given /^I am in the home page$/ <span class="operator"><span class="keyword">do</span></span><br><span class="line">  @login_page = LoginPage.<span class="keyword">new</span>(Capybara.current_session)</span><br><span class="line">  @login_page.visit</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">When</span> /^<span class="keyword">I</span> login <span class="keyword">with</span> usernmae <span class="string">"test"</span> <span class="keyword">and</span> <span class="keyword">password</span> <span class="string">"test"</span>$/ <span class="keyword">do</span> |<span class="keyword">name</span>, <span class="keyword">password</span>|</span><br><span class="line">  @login_page.login <span class="keyword">name</span>, <span class="keyword">password</span></span><br><span class="line"><span class="keyword">end</span></span></span><br></pre></td></tr></table></figure>
<h3 id="2-__u4F7F_u7528_u73B0_u6210_u7684_gem"><a href="#2-__u4F7F_u7528_u73B0_u6210_u7684_gem" class="headerlink" title="2. 使用现成的 gem"></a>2. 使用现成的 gem</h3><p>ruby 界最不缺的就是第三方实现了。github 里一搜一大把。</p>
<h4 id="u6211_u6700_u65E9_u7528_u7684_u662F_cheezy/page-object"><a href="#u6211_u6700_u65E9_u7528_u7684_u662F_cheezy/page-object" class="headerlink" title="我最早用的是 cheezy/page-object"></a>我最早用的是 <code>cheezy/page-object</code></h4><p>&gt;</p>
<blockquote>
<ol>
<li>A Simple DSL you can use to define and interact with the content on your page</li>
<li>Support for both watir-webdriver and selenium-webdriver</li>
<li>An easy way of creating and using page objects in your cucumber steps or in rspec</li>
<li>A Simple way of dealing with Frames and iFrames</li>
<li>Robust way of dealing with Ajax Calls</li>
<li>A clean way of handling Javascript Popups</li>
<li>Support for most html Elements</li>
</ol>
</blockquote>
<p>使用非常简单：</p>
<p>login_page.rb</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span></span></span><br><span class="line">  <span class="keyword">include</span> <span class="constant">PageObject</span></span><br><span class="line"></span><br><span class="line">  text_field(<span class="symbol">:username</span>, <span class="symbol">:id</span> =&gt; <span class="string">'username'</span>)</span><br><span class="line">  text_field(<span class="symbol">:password</span>, <span class="symbol">:id</span> =&gt; <span class="string">'password'</span>)</span><br><span class="line">  button(<span class="symbol">:login</span>, <span class="symbol">:id</span> =&gt; <span class="string">'login'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">login_with</span><span class="params">(username, password)</span></span></span><br><span class="line">    <span class="keyword">self</span>.username = username</span><br><span class="line">    <span class="keyword">self</span>.password = password</span><br><span class="line">    login</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>login_stepdef.rb</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">Given</span> /^<span class="constant">I</span> am <span class="keyword">in</span> the home page<span class="variable">$/</span> <span class="keyword">do</span></span><br><span class="line">  visit <span class="constant">HOME_PATH</span></span><br><span class="line">  <span class="variable">@login_page</span> = <span class="constant">LoginPage</span>.new(<span class="constant">Capybara</span>.current_session)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">When</span> /^<span class="constant">I</span> login with usernmae <span class="string">"test"</span> <span class="keyword">and</span> password <span class="string">"test"</span><span class="variable">$/</span> <span class="keyword">do</span> |name, password|</span><br><span class="line">  <span class="variable">@login_page</span>.login_with name, password</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>具体可以移步：<a href="https://github.com/cheezy/page-object/wiki/Get-me-started-right-now!" target="_blank" rel="external">Get started!</a></p>
<p>说心里话，如果不是用 capybara 的话， 在 ruby 下写 webdriver 自动化，必然首选 <code>cheezy/page-object</code>。</p>
<h4 id="u6211_u4EEC_u8FD9_u6B21_u9009_u62E9_u4E86_SitePrism"><a href="#u6211_u4EEC_u8FD9_u6B21_u9009_u62E9_u4E86_SitePrism" class="headerlink" title="我们这次选择了 SitePrism"></a>我们这次选择了 <a href="https://github.com/natritmeyer/site_prism" target="_blank" rel="external">SitePrism</a></h4><blockquote>
<p>A Page Object Model DSL for Capybara<br>SitePrism gives you a simple, clean and semantic DSL<br>for describing your site using the Page Object Model pattern, for use with Capybara in automated acceptance testing.</p>
</blockquote>
<p>在 cucumber 中使用 SitePrism 需要加入依赖</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">'capybara'</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">'capybara/cucumber'</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">'selenium-webdriver'</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">'site_prism'</span></span><br></pre></td></tr></table></figure>
<p>其实只要在 Gemfile 中加入以下 gem 即可：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">gem</span> <span class="string">"cucumber-rails"</span></span><br><span class="line">gem <span class="string">"capybara"</span></span><br><span class="line">gem <span class="string">"site_prism"</span>, <span class="string">"~&gt; 2.4"</span></span><br></pre></td></tr></table></figure>
<p>使用同样非常简单：</p>
<p>login_page.rb</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPage</span> <span class="inheritance">&lt; <span class="parent">SitePrism::Page</span></span></span></span><br><span class="line">  set_url <span class="string">"/login"</span></span><br><span class="line"></span><br><span class="line">  element <span class="symbol">:username_input_field</span>, <span class="string">"input[name='username']"</span></span><br><span class="line">  element <span class="symbol">:password_input_field</span>, <span class="string">"input[name='password']"</span></span><br><span class="line">  element <span class="symbol">:login_button</span>, <span class="string">"button[name='login']"</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">login_with</span> <span class="title">username</span>, <span class="title">password</span></span></span><br><span class="line">    username_input_element.type username</span><br><span class="line">    password_input_element.type username</span><br><span class="line">    login_button.click</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>login_stepdef.rb</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">Given</span> /^<span class="constant">I</span> am <span class="keyword">in</span> the home page<span class="variable">$/</span> <span class="keyword">do</span></span><br><span class="line">  <span class="variable">@login_page</span> = <span class="constant">LoginPage</span>.new <span class="comment"># 不用传 driver 哦~</span></span><br><span class="line">  <span class="variable">@login_page</span>.load</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">When</span> /^<span class="constant">I</span> login with usernmae <span class="string">"test"</span> <span class="keyword">and</span> password <span class="string">"test"</span><span class="variable">$/</span> <span class="keyword">do</span> |name, password|</span><br><span class="line">  <span class="variable">@login_page</span>.login_with name, password</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>可以看得出，page object 的方案还是很多的，自己定义比较灵活，轻巧，使用 gem 可以省去不少心思。<br>个人建议是，使用 gem， 如果gem 无法完成的，再上自己封装！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/cucumber/">cucumber</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/capybara/">capybara</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cucumber/">cucumber</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pageobject/">pageobject</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-08-07-step-defintionshi-kong" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-08-07-step-defintionshi-kong/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-08-07-step-defintionshi-kong/">由 step definition 失控引发的讨论和思考</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="u5F15_u5B50"><a href="#u5F15_u5B50" class="headerlink" title="引子"></a>引子</h2><p>公司在新项目上 BDD 的开发模式，迄今已经差不多 2 个月了。<br>按最初的分工，开发写 rspec， 测试写 cucumber，双线并行。<br>加上最新配置好的 jenkins ci 环境，整个开发流程走的很顺，<br>代码质量也得到了很好的控制。</p>
<p>今天按老样子写某个 component 的新加的feature的场景，<br>写 step definition 的时候，发现 stepdef.rb 文件已经<br>300 多行了。 瞬间有种再不控制就爆炸的感觉。</p>
<p>于是就把问题抛了出去：</p>
<blockquote>
<p>cucumber 的 step definition 爆了。。。 越写越多，真难控制！</p>
</blockquote>
<h2 id="u8BA8_u8BBA"><a href="#u8BA8_u8BBA" class="headerlink" title="讨论"></a>讨论</h2><p>我将问题抛在了 TestCirle 的群里，讨论地断断续续从下午一点到下午六点。我将每个人的发言总结下。</p>
<p><em>MIC-Seeyon</em></p>
<blockquote>
<p>step_definition 之上抽象一些 common function，再之上是 page object 的应用。<br>这样基本就封装了大部分逻辑了。这样就算 step_definition 再有多，也不会有多少代码吧～</p>
<p>如果有页面很多 ajax 操作，你可以把 ajax 的基础页写成 basePage，<br>然后其他的 ajax 业务写成不同的 page，继承 basePage 即可～</p>
<p>如果觉得实现太重的话，可以分工程，通用的抽取出来，其他的不同模块或者业务，基于这部分 common 的，搞自己的 feature，自己实现～<br>这样对具体的编码的人来说就轻了～</p>
<p>把握好 feature 的度, 整理一下测试用例的执行场景哦～</p>
<p>step definition 里面有太多冗余的东西的话就会很重，需要去冗。<br>如果有的话，那也得做一层基本的网页操作的抽象～<br>我是说业务和交互级别的 actions<br>比如根据 label 操作 input<br>各种条目的选择，操作，内容获取<br>这些可能都跟你产品的前段设计有关哦～</p>
<p>我们是这么做的：</p>
<ol>
<li>webdriver 的 api 操作封装一层</li>
<li>然后产品使用的前段控件封装一层</li>
<li>然后业务级别的逻辑跟操作封装一层</li>
<li>然后常用的操作组合封装一个层</li>
<li>最后才是 step definition</li>
</ol>
<p>cucumber就是一个驱动自动化测试的粘合剂</p>
</blockquote>
<p><em>横刀天笑</em></p>
<blockquote>
<p>逻辑肯定是在 page object 里的, page object 应该暴露业务接口，既然暴露业务接口，那肯定是包含业务逻辑的<br>比如我们酒店首页 HotelHomePage。有个搜索功能，那 肯定提供一个 search 的方法，search 里接受一个查询条件</p>
<p>page object，应该从用户角度来看，你这个页面提供了哪些功能,从业务功能上来看 po，而不是从操作上, 然后 step defs 里是流程的描述</p>
<p>持续交付里有一章讲自动化测试, 里面讲了一个三层:</p>
<ol>
<li>测试描述层(case)</li>
<li>测试实现层，或者叫流程层</li>
<li>应用接口层(比如使用 selenium 或 httpclient 之类的和应用程序打交道)</li>
</ol>
</blockquote>
<p><em>插曲 -_-!</em></p>
<blockquote>
<p>如何做一个能害死人的自动化测试工具<br><a href="http://www.ltesting.net/ceshi/ceshijishu/zdcs/2013/0806/206547.html?1375845711" target="_blank" rel="external">http://www.ltesting.net/ceshi/ceshijishu/zdcs/2013/0806/206547.html?1375845711</a></p>
</blockquote>
<h2 id="u601D_u8003"><a href="#u601D_u8003" class="headerlink" title="思考"></a>思考</h2><p>我回想了下，这个项目一开始没采用 page object， 因为：</p>
<ol>
<li>以为项目不复杂，参考另一个公司 rails 项目的 cucumber features。</li>
<li>使用了 pickle，导致 feature 撰写的时候， 有过多的 code 色彩，如果使用 page object 的话 就有点混搭的感觉，不伦不类了。</li>
<li>最早之前用 page object 有些厌倦了。 特别 ajax render 的页面，导致继承 base 的页面过多。</li>
</ol>
<h3 id="u5173_u4E8E_u7B2C_u4E00_u70B9_uFF1A"><a href="#u5173_u4E8E_u7B2C_u4E00_u70B9_uFF1A" class="headerlink" title="关于第一点："></a>关于第一点：</h3><p>接触过很多 rails 的项目， 往往是将 cucumber features 作为 High level 的 acceptance test， 挑选的场景的粒度都是比较粗。<br>而且 rails 项目的 cucumber 基本都是开发来写的，我一开始就把自己定位为开发。</p>
<h3 id="u5173_u4E8E_u7B2C_u4E8C_u70B9_uFF1A"><a href="#u5173_u4E8E_u7B2C_u4E8C_u70B9_uFF1A" class="headerlink" title="关于第二点："></a>关于第二点：</h3><p><a href="https://github.com/ianwhite/pickle" target="_blank" rel="external">pickle</a> 非常强大</p>
<blockquote>
<p>Pickle gives you cucumber steps that create your models easily from<br>factory-girl, machinist, or fabrication. You can also just use ActiveRecord as a factory but it’s not as cool.</p>
</blockquote>
<p>但是使用 pickle 的前提是你必须了解 model， 了解各种 model 的 factory， 也就是其实你已经<br>是从开发的角度来考虑如何测试代码了。 你在 steps 里面的数据设计，其实都是你知道的结果，并不是测试出来的。</p>
<p>pickle 的使用，使 <code>Given</code>, <code>When</code> 和 <code>And</code> 对 测试和 stakeholder 不太友好。 这不像 page object 的风格。</p>
<h3 id="u5173_u4E8E_u7B2C_u4E09_u70B9"><a href="#u5173_u4E8E_u7B2C_u4E09_u70B9" class="headerlink" title="关于第三点"></a>关于第三点</h3><p>我在前面一个项目中应用了 <code>Page Object</code>， 我在博客里也粗略地介绍过， 参考 <a href="/categories.html#webdriver-ref">webdriver</a><br>由于我们项目大量使用 ajax， 导致基于 basePage 的子页面各种各样的特别多。个人感觉也不太舒服。</p>
<p>综上，所以一开始就忽略了 page object。</p>
<h3 id="u76EE_u524D"><a href="#u76EE_u524D" class="headerlink" title="目前"></a>目前</h3><p>我们现在仅仅把 features 进行了分类（利用目录结构），将所有的 step definition 都放在了一个 rb 文件里。随着以后的不同的场景，失控也是时间问题。</p>
<h2 id="u7ED3_u8BBA"><a href="#u7ED3_u8BBA" class="headerlink" title="结论"></a>结论</h2><p>目前看来， 这个项目的 cucumber 想要完成的是 <code>整个 UI 的自动化测试</code>。 要去冗，去重需要做的是：</p>
<ol>
<li>合并和参数化</li>
<li>Page Object</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/cucumber/">cucumber</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cucumber/">cucumber</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pageobject/">pageobject</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-08-06-git-revert" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-08-06-git-revert/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-08-06-git-revert/">git revert</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>最近一直在 github 上提交代码，所以总会遇到提交的代码 broken 了之前的 function。</p>
<blockquote>
<p>Perhaps you didn’t have enough coffee that morning, or it was just before lunch. </p>
</blockquote>
<p>其实这还无关紧要，再提交一个修复下就可以了。 但是也会遇到比较头疼的， 比如：</p>
<p><img src="/photos/git_graph_error.jpg" alt=""></p>
<p>注意蓝色这条线的 merge 那个点，开发同学因为粗心忘记把自动 merge 的代码提交了。<br>黑色这条线的同学，如果 pull 下来，就会发现一部分代码回到了蓝线的起点时候的状态。<br>然后呢，黑线这边的 merge 就会导致部分代码 rollback 了。很悲催吧。这个时候呢，提交修复也不太可能，最好的办法就是 <code>revert</code> 了。</p>
<h3 id="u6982_u5FF5"><a href="#u6982_u5FF5" class="headerlink" title="概念"></a>概念</h3><p><code>git revert</code> 命令撤销一个 commit。它的做法是提交一个新的 commit， 这个 commit 里面将你要回滚的 commit 的修改全部撤销。<br>所以它不会破坏你的历史。如图所示：提交一个新的 commit （蓝球）， 撤销灰球修改。</p>
<p><img src="/photos/git-tutorial_changes-revert.png" alt=""></p>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git revert &lt;commit&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><a href="http://gitready.com/intermediate/2009/03/16/rolling-back-changes-with-revert.html" target="_blank" rel="external">http://gitready.com/intermediate/2009/03/16/rolling-back-changes-with-revert.html</a></p>
<p>假设我们有这样一个 git 历史：</p>
<p><img src="/photos/revert1.png" alt=""></p>
<p>我们来一次 revert</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git revert HEAD</span><br><span class="line">Finished one revert.</span><br><span class="line">[master]: created <span class="number">1</span>e689e2: </span><br><span class="line">  <span class="string">"Revert "</span>Updated to Rails <span class="number">2.3</span>.<span class="number">2</span> and edge hoptoad_notifier<span class="string">""</span></span><br></pre></td></tr></table></figure>
<p>revert 命令会自动帮你 commit， 并为你生成 commit 信息: Revert + 被回滚的 commit 的信息。<br>这里就是 “Revert “Updated to Rails 2.3.2 and edge hoptoad_notifier””</p>
<p>再来看下 revert 后的历史图：</p>
<p><img src="/photos/revert2.png" alt=""></p>
<p>可以看到 revert 的在最前面添加了一个 commit。</p>
<blockquote>
<p>By default using this command will bring up your $EDITOR so you can modify the commit message of the revert.<br>Use this to explain why the changes are being backed out!<br>If for some reason you don’t want to edit the commit message, tacking on <code>--no-edit</code> will allow you do so.</p>
</blockquote>
<p>另外如果你不想 commit 的话，还可以用 <code>-n</code> 参数</p>
<blockquote>
<p>Another helpful option is the -n or –no-commit flag.<br>This will simply leave the reverted changes in your working directory and not automatically commit them.<br>If you need to edit files further to complete the revert or possibly revert more than one commit, try out this option.</p>
</blockquote>
<p>接着，我们是试试看 revert 一个 merge 的 commit</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git revert HEAD~<span class="number">1</span></span><br><span class="line">fatal: Commit <span class="number">137</span>ea95 is a merge but no -m option was given.</span><br></pre></td></tr></table></figure>
<p>它告诉你 commit 137ea95 是一个 merge， 需要你指定一个 -m 的option。 </p>
<blockquote>
<p>-m parent-number, –mainline parent-number<br>Usually you cannot revert a merge because you do not know which side of the merge should be considered the mainline.<br>This option specifies the parent number (starting from 1) of the mainline and allows revert to reverse the change relative to the specified parent.</p>
</blockquote>
<p>意思是，你需要指定一个 parent number （从1开始），然后 revert 会将基于这个 parent number 的改变都回滚。</p>
<p>再来看下 merge commit 的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> HEAD~<span class="number">1</span> -<span class="number">1</span></span><br><span class="line">commit <span class="number">137</span>ea95c911633d3e908f6906e3adf6372cfb0ad</span><br><span class="line">Merge: <span class="number">5</span>f576a9... <span class="number">62</span>db4af...</span><br><span class="line">Author: Nick Quaranto &lt;nick@quaran.to&gt;</span><br><span class="line">Date:   Mon Mar <span class="number">16</span> <span class="number">16</span>:<span class="number">22</span>:<span class="number">37</span> <span class="number">2009</span> -<span class="number">0400</span></span><br><span class="line"></span><br><span class="line">    Merging <span class="keyword">in</span> rails-<span class="number">2.3</span> branch</span><br></pre></td></tr></table></figure>
<p>可以看到 <code>5f576a9</code> 和 <code>62db4af</code> 被 merge 了。</p>
<p>所以</p>
<ol>
<li><code>git revert HEAD~1 -m 1</code> 就会 revert 基于 <code>5f576a9</code> 所发生的变化 </li>
<li><code>git revert HEAD~1 -m 2</code> 就会 revert 基于 <code>62db4af</code> 所发生的变化  </li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git revert HEAD~<span class="number">1</span> --no-edit --mainline <span class="number">2</span></span><br><span class="line">Finished one revert.</span><br><span class="line">[master]: created <span class="number">526</span>b346: <span class="string">"Revert "</span>Merging <span class="keyword">in</span> rails-<span class="number">2.3</span> branch<span class="string">""</span></span><br><span class="line"></span><br><span class="line">$ git <span class="built_in">log</span> -<span class="number">1</span></span><br><span class="line">commit d64d3983845dfa18a5d935c7ac5a4855c125e474</span><br><span class="line">Author: Nick Quaranto &lt;nick@quaran.to&gt;</span><br><span class="line">Date:   Mon Mar <span class="number">16</span> <span class="number">19</span>:<span class="number">24</span>:<span class="number">45</span> <span class="number">2009</span> -<span class="number">0400</span></span><br><span class="line"></span><br><span class="line">    Revert <span class="string">"Merging in rails-2.3 branch"</span></span><br><span class="line"></span><br><span class="line">    This reverts commit <span class="number">137</span>ea95c911633d3e908f6906e3adf6372cfb0ad, reversing</span><br><span class="line">    changes made to <span class="number">62</span>db4af8c77852d2cc9c19efc6dfb97e0d0067f5.</span><br></pre></td></tr></table></figure>
<p>很明确的告诉你， 这个 revert 提交了一个 commit： 137ea95c911633d3e908f6906e3adf6372cfb0ad，这个 commit 把 merge 操作对 62db4af8c77852d2cc9c19efc6dfb97e0d0067f5 发生的改变都回滚了。</p>
<h3 id="u901A_u4FD7_u8BF4_u6CD5"><a href="#u901A_u4FD7_u8BF4_u6CD5" class="headerlink" title="通俗说法"></a>通俗说法</h3><ol>
<li>普通的 revert： 比如桌上有一碗饭， 我吃完了，然后我又把这碗饭填满，像没吃一样， 填满的动作就是 revert。 看上去桌上的饭没有动过，但是事情其实发生了，就是历史没有被改变。</li>
<li>merge 的 revert：桌上有一碗饭，A 加了一道菜， B 加了一碗汤， merge 之后就是有饭有菜有汤。 现在在有饭有菜有汤的情况下去掉汤， 就是 <code>git revert &quot;commit of merge&quot; -m 菜</code>。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/git/">git</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-08-02-ba-yue-er-ri-gong-zuo-suo-shi" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-08-02-ba-yue-er-ri-gong-zuo-suo-shi/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-08-02-ba-yue-er-ri-gong-zuo-suo-shi/">8-02-工作琐事</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="Xpath_//_Trap"><a href="#Xpath_//_Trap" class="headerlink" title="Xpath // Trap"></a>Xpath // Trap</h3><p>I am trying to loacte a attr element in a label context using capybara. The html looks like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"post_name"</span>&gt;</span></span><br><span class="line">      Name<span class="tag">&lt;<span class="title">attr</span> <span class="attribute">title</span>=<span class="value">"required"</span>&gt;</span>*<span class="tag">&lt;/<span class="title">attr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>And I use the code like:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">within <span class="string">"div.post"</span></span><br><span class="line"></span><br><span class="line">  label = page.find <span class="string">"label"</span>, <span class="string">"Name"</span></span><br><span class="line">  label.find <span class="symbol">:xpath</span>, <span class="string">"//attr[@title=\"required\"]"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>As usual, I’m pretty sure that the find will work like:</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//label//attr</span></span><br></pre></td></tr></table></figure>
<p>the find search the xpath in label context and find it.</p>
<p>Quite easy but I’m wrong.</p>
<p>In XPath the expression // means something very specific, and it might not be what you think.<br>Contrary to common belief, // means <red>anywhere in the document</red> not <red>anywhere in the current context</red>.<br>As an example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.find(<span class="symbol">:xpath</span>, <span class="string">'//body'</span>).all(<span class="symbol">:xpath</span>, <span class="string">'//script'</span>)</span><br></pre></td></tr></table></figure>
<p>You might expect this to find all script tags in the body,<br>but actually, it finds all script tags in the entire document,<br>not only those in the body! What you’re looking for is the .// expression which means “any descendant of the current node”:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.find(<span class="symbol">:xpath</span>, <span class="string">'//body'</span>).all(<span class="symbol">:xpath</span>, <span class="string">'.//script'</span>)</span><br></pre></td></tr></table></figure>
<p>The same thing goes for within:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">within(<span class="symbol">:xpath</span>, <span class="string">'//body'</span>) <span class="keyword">do</span></span><br><span class="line">  page.find(<span class="symbol">:xpath</span>, <span class="string">'.//script'</span>)</span><br><span class="line">  within(<span class="symbol">:xpath</span>, <span class="string">'.//table/tbody'</span>) <span class="keyword">do</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>You can refer to <a href="https://github.com/jnicklas/capybara" target="_blank" rel="external">capybara document</a></p>
<p>And also there is a great post: <a href="http://www.bennadel.com/blog/2142-Using-And-Expressions-In-XPath-XML-Search-Directives-In-ColdFusion.htm" target="_blank" rel="external">Using “//“ And “.//“ Expressions In XPath XML Search Directives In ColdFusion</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/workdiary/">WorkDiary</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/capybara/">capybara</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xpath/">xpath</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-12-26-fan-yi-android-and-ios-support" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-12-26-fan-yi-android-and-ios-support/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-12-26-fan-yi-android-and-ios-support/">[翻译]Android and iOS Support</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>简而言之：我们准备淘汰 Selenium 自己的 AndroidDriver 和 iPhoneDriver，改用 Selendroid，iosdriver 和 Appium中的任意一个。如果你正在使用 Selenium 的 mobile driver 中的一个的话，请评价下这些替代品。</p>
<p>正文：</p>
<p>在 2007 年， 乔布斯发布了 iPhone，从此移动web从本来的新奇事物走上了主流，成为大众的宠儿。如今的趋势预示着在不远的将来，移动 web 的使用将超过桌面应用的使用。移动 Web 将成为你站点重要一部分，而且在移动设备上测试你的网站将是一个明智的想法。而这在未来将会持续一段时间。</p>
<p>Selenium 项目通过实现 iOS 和 Android 版本的 webdriver 来回应崛起的移动 web。在2009年初期，我们加入了 iPhoneDriver (在 iPad 上也能工作)。2010年6月，最初由 Google 工程师开发的 AndroidDriver 也加入了阵营。 直到今天，你能在官方 Android SDK 的下载选项中发现 “Google WebDriver”的身影。</p>
<p>在最初的工作完成之后，一些有趣的事情发生了。在 Selenium 项目之外，坊间对这些移动 driver 做了很多实验性的扩展和修改。第一个就是“nativedriver”，我也参与于此。它采用了一个新奇的方式，使用熟悉的 WebDriver 接口，允许用户和手机(Android 或者 iOS)原生的 UI 交互。我第一次见到它时，惊呆了。但是开发它的工程师很快就向我证明了这是有意义的。你猜怎样，他们是对的。</p>
<p>可惜的是，在证明这个主意是可行且能工作后，NativeDriver 项目突然失去了动力。但是，它给其他三个项目做好了准备，这三个项目采用了它的理念，创造了非常棒的移动测试软件，他们就是：  Selendroid， iosdriver 和 Appium。这三个项目都允许用户用熟知的 WebDriver 接口来测试iOS 和 Android 上的应用。不仅仅是原生的应用，也包括混合或者纯web的应用。最近 Windows Phone WebDriver 也加入了他们，我们可以用来测试 WinPhone 8 上的移动 web 应用。</p>
<p>这些项目都有一个共同点：他们比 Selenium 移动主项目更加地活跃，更能胜任移动测试工作，也已经走的更远。事实上，原先在 AndroidDriver 和 iPhoneDriver 上的贡献者也开始在这些项目上工作了。我们需要维护不同 driver 间的互通性，允许用户选择最适合他们的框架，而不必担心他们的测试会需要大量重构。</p>
<p>这就意味着在 selenium 项目中继续保留 AndroidDriver 和 iPhoneDriver 已经不能帮助用户了。那些替代者才是更好的选择。保留这些所谓官方的 driver 只会污染了项目。而且更糟糕的是，selenium 的开发修复这些 driver 上的 bug 非常慢，而这些 bug 让每个参与与此的人都非常沮丧。鉴于此，Selenium 项目决定删除这些driver的代码。我们推荐大家评估那些备选的其中之一使用。</p>
<p>当然，这些代码会仍然保留在我们的代码历史中，所以如果你想自己构建一个的话，还是有可能的。最新的 iPhoneDriver 是 ef9d578，最新的 AndroidDriver 代码是 00a3c7d。我们已经上传了最新版本的 AndroidDriver 供你下载。</p>
<p>这些改变并不意味着我们不再支持移动测试。它意味着我们只支持最好的 mobile WebDriver 实现，只是他们不是 Selenium 项目的一部分而已。</p>
<p>原文见 <a href="http://seleniumhq.wordpress.com/2013/12/24/android-and-ios-support/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+Selenium+%28The+Official+Selenium+Blog%29" target="_blank" rel="external">http://seleniumhq.wordpress.com/2013/12/24/android-and-ios-support/?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+Selenium+%28The+Official+Selenium+Blog%29</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动测试/">移动测试</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2012-03-04-zsh-config-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2012-03-04-zsh-config-post/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2012-03-04-zsh-config-post/">oh my zsh</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Mac自带zsh， 先设置你的默认shell为zsh</p><br><pre class="prettyprint"><br>chsh -s /bin/zsh<br></pre><br><p><br>然后使用oh-my-zsh的配置。参见<a href="https://github.com/robbyrussell/oh-my-zsh/" target="_blank" rel="external">oh my zsh</a><br><pre class="prettyprint"><br>cd ~<br>curl -L <a href="https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh</a> | sh</pre><br></p><br><p>修改.zshrc,把你需要的环境变量配置全部加到.zshrc中去。定义自己的主题。可以在.oh-my-zsh/themes下面找到所有的主题<br>同时你也可以去<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes" target="_blank" rel="external">themes</a>里去找你喜欢的主题。个人比较喜欢gnzh.<br><pre class="prettyprint"><br>zhangmatoMacBook-Pro.local ~/.oh-my-zsh/themes  ‹master›<br>Soliah.zsh-theme              daveverwer.zsh-theme          frisk.zsh-theme               josh.zsh-theme                mikeh.zsh-theme               rgm.zsh-theme                 suvash.zsh-theme<br>afowler.zsh-theme             dieter.zsh-theme              funky.zsh-theme               jreese.zsh-theme              miloshadzic.zsh-theme         risto.zsh-theme               takashiyoshida.zsh-theme<br>…<br></pre><br></p><br><p>安装插件，在.zshrc文件里找到”plugins=”,然后在里面添加你所需要的插件，你安装的插件可以在.oh-my-zsh/plugins下面找到。<br><pre class="prettyprint"><br>plugins=(rails3 rails git textmate ruby rvm gem git github brew bundler textmate pow)<br></pre><br></p>

<p><br>重启下终端，然后就可以使用订制好的zsh了。<br></p><br><p><br><img src="/photos/zsh.png"><br></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-06-27-ruby-here-doc" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-06-27-ruby-here-doc/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-06-27-ruby-here-doc/">ruby 的 Heredocs</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>看 <a href="https://github.com/capistrano">Capistrano</a> 源码， 在 <code>capistrano / bin / capify</code> 下，发现<br><code>here doc</code> 的写法，</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unindent</span><span class="params">(string)</span></span></span><br><span class="line">  indentation = string[<span class="regexp">/\A\s*/</span>]</span><br><span class="line">  string.strip.gsub(<span class="regexp">/^<span class="subst">#&#123;indentation&#125;</span>/</span>, <span class="string">""</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"> <span class="string">"Capfile"</span> =&gt; unindent(&lt;&lt;-<span class="constant">FILE</span>),</span><br><span class="line"></span><br><span class="line">    load <span class="string">'deploy'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Uncomment if you are using Rails' asset pipeline</span></span><br><span class="line">    <span class="comment"># load 'deploy/assets'</span></span><br><span class="line"></span><br><span class="line">    load <span class="string">'config/deploy'</span> <span class="comment"># remove this line to skip loading any of the default tasks</span></span><br><span class="line">  <span class="constant">FILE</span></span><br></pre></td></tr></table></figure>
<p>孤陋寡闻的我立马google 了一把找到篇好文，抄下来分享：</p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ruby/">ruby</a>
	</div>


      
      
        <p class="article-more-link">
          <a  href="/2015/12/16/2013-06-27-ruby-here-doc/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-06-26-shell-script-to-control-tomcat" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-06-26-shell-script-to-control-tomcat/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-06-26-shell-script-to-control-tomcat/">能马上用起来的控制 tomcat 的脚本</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>难的在网上找到的能马上用起来的 shell 脚本，心情愉悦啊！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span><br><span class="line"></span></span><br><span class="line"><span class="built_in">export</span> BASE=/home/programs/jakarta-tomcat-<span class="number">5.0</span>.<span class="number">28</span>/bin</span><br><span class="line">prog=jakarta-tomcat-<span class="number">5.0</span>.<span class="number">28</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stat</span></span>() &#123;</span><br><span class="line"><span class="keyword">if</span> [ `ps auxwwww|grep <span class="variable">$prog</span>|grep -v grep|wc <span class="operator">-l</span>` <span class="operator">-gt</span> <span class="number">0</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> Tomcat is running.</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> Tomcat is not running.</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ `ps auxwwww|grep <span class="variable">$prog</span>|grep -v grep|wc <span class="operator">-l</span>` <span class="operator">-gt</span> <span class="number">0</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> Tomcat seems to be running. Use the restart option.</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="variable">$BASE</span>/startup.sh <span class="number">2</span>&gt;&amp;<span class="number">1</span> &gt; /dev/null</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">stat</span></span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line"><span class="variable">$BASE</span>/shutdown.sh <span class="number">2</span>&gt;&amp;<span class="number">1</span> &gt; /dev/null</span><br><span class="line"><span class="keyword">if</span> [ `ps auxwwww|grep <span class="variable">$prog</span>|grep -v grep|wc <span class="operator">-l</span>` <span class="operator">-gt</span> <span class="number">0</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> `ps auxwww|grep <span class="variable">$prog</span>|grep -v grep|tr <span class="operator">-s</span> <span class="string">' '</span>|cut <span class="operator">-d</span> <span class="string">' '</span> <span class="operator">-f</span>2`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">kill</span> -<span class="number">9</span> <span class="variable">$pid</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> &gt; /dev/null</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">stat</span></span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ `ps auxwwww|grep <span class="variable">$prog</span>|grep -v grep|wc <span class="operator">-l</span>` <span class="operator">-gt</span> <span class="number">0</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">for</span> pid <span class="keyword">in</span> `ps auxwww|grep <span class="variable">$prog</span>|grep -v grep|tr <span class="operator">-s</span> <span class="string">' '</span>|cut <span class="operator">-d</span> <span class="string">' '</span> <span class="operator">-f</span>2`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">kill</span> -<span class="number">9</span> <span class="variable">$pid</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> &gt; /dev/null</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="variable">$BASE</span>/startup.sh <span class="number">2</span>&gt;&amp;<span class="number">1</span> &gt; /dev/null</span><br><span class="line"><span class="built_in">stat</span></span><br><span class="line">;;</span><br><span class="line">status)</span><br><span class="line"><span class="built_in">stat</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Usage: tomcat start|stop|restart|status"</span></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<p>参见 <a href="http://www.techpaste.com/2012/01/shell-script-control-stopstartrestartstatus-tomcat-application-server/" target="_blank" rel="external">http://www.techpaste.com/2012/01/shell-script-control-stopstartrestartstatus-tomcat-application-server/</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-05-26-zai-webdriverli-shi-yong-sizzle-dot-js" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/16/2013-05-26-zai-webdriverli-shi-yong-sizzle-dot-js/" class="article-date">
  	<time datetime="2015-12-16T11:37:46.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2013-05-26-zai-webdriverli-shi-yong-sizzle-dot-js/">在WebDriver里使用Sizzle.js</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>##XPATH vs CSS</p>
<p>2008年的时候， 开始使用 Selenium RC 来写 Web 自动化测试，用的是 XPATH 定位，在 Firefox 上工作的很好，可惜在 IE 上跑不起来。<br>因为后来转去做开发工作，对此问题也没深究。时隔5年，09年时候转测试，已经4年多了。Selenium RC 都变成了 WebDriver， 从2013 GTAC 来看，<br>WebDriver 逐渐成为 Web 自动化的主流框架。</p>
<p>WebDriver 同样使用 XPATH 和 CSS locator。孰优孰劣，google 一下，一大把，不过目前风向偏向 CSS， 理由如下</p>
<ol>
<li>更快(尤其在 IE 上)</li>
<li>更简单</li>
<li>更加可读</li>
<li>符合 Jquery 定位逻辑</li>
<li>XPATH 在不同浏览器上的实现可能不太一样，也许在 Firefox 工作，在 IE 上就不一定了。</li>
<li>CSS 可以引入第三方的 Javascript 库来更好的定位元素， 比如马上要说的 Sizzle.js</li>
</ol>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
        <p class="article-more-link">
          <a  href="/2015/12/16/2013-05-26-zai-webdriverli-shi-yong-sizzle-dot-js/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2015 恒温
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >本站到访数: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, 本页阅读量: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    
	<script>
		var yiliaConfig = {
			fancybox: false,
			mathjax: true,
			animate: true,
			isHome: true,
			isPost: false,
			isArchive: false,
			isTag: false,
			isCategory: false,
			open_in_new: false
		}
	</script>


<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>