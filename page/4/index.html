<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>八点下班</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta property="og:type" content="website">
<meta property="og:title" content="八点下班">
<meta property="og:url" content="http://8atmyhouse.com/page/4/index.html">
<meta property="og:site_name" content="八点下班">
<meta property="og:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八点下班">
<meta name="twitter:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
  
    <link rel="alternative" href="/atom.xml" title="八点下班" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">恒温</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/about/">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/metro/" style="font-size: 10px;">Metro</a> <a href="/tags/capybara/" style="font-size: 17.5px;">capybara</a> <a href="/tags/cucumber/" style="font-size: 15px;">cucumber</a> <a href="/tags/factory-gril/" style="font-size: 10px;">factory_gril</a> <a href="/tags/git/" style="font-size: 12.5px;">git</a> <a href="/tags/nexus-7-2013/" style="font-size: 10px;">nexus 7 2013</a> <a href="/tags/pageobject/" style="font-size: 12.5px;">pageobject</a> <a href="/tags/test-china-org/" style="font-size: 20px;">test-china.org</a> <a href="/tags/vim/" style="font-size: 12.5px;">vim</a> <a href="/tags/xpath/" style="font-size: 10px;">xpath</a> <a href="/tags/性能测试/" style="font-size: 10px;">性能测试</a> <a href="/tags/游戏开发/" style="font-size: 10px;">游戏开发</a> <a href="/tags/翻译/" style="font-size: 10px;">翻译</a> <a href="/tags/陆犯焉识/" style="font-size: 10px;">陆犯焉识</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">专注于前端</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">恒温</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">恒温</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/about/">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2013-04-28-jmeter-bing-qi-pu-zhi-foreach-controller" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/04/27/2013-04-28-jmeter-bing-qi-pu-zhi-foreach-controller/" class="article-date">
  	<time datetime="2013-04-27T13:37:00.000Z" itemprop="datePublished">2013-04-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/04/27/2013-04-28-jmeter-bing-qi-pu-zhi-foreach-controller/">JMeter 兵器谱之 ForEach Controller</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>同样的，英文好的同学请移驾<a href="http://jmeter.apache.org/usermanual/component_reference.html#ForEach_Controller" target="_blank" rel="external">ForEach Controller</a></p>
<p>ForEach controller 是用来遍历集合的，比如 XPATH Extractor 或者 正则表达式 Extractor 解析出来的集合。ForEach做的事情大致有2件，</p>
<ol>
<li>取得集合</li>
<li>遍历集合，将每一个值应用到 ForEach 下面的 Smapler 或者 controller 中去。</li>
</ol>
<p>来看一个例子，我们要访问百度首页，取得首页所有的链接，然后访问这些链接。我们要做的是：</p>
<ol>
<li>用一个 http sample 访问 <a href="http://www.baidu.com" target="_blank" rel="external">http://www.baidu.com</a></li>
<li>在这个 sample 下添加一个正则表达式提取器，使用 &lt;a href=”([^”]+)” 提取所有的 link 的 href 值。</li>
<li>用 ForEach Controller 遍历第2步提取出来的 href 值，然后一一访问。</li>
</ol>
<p>JMeter 脚本结构大致如下，</p>
<p><img src="http://jmeter.apache.org/images/screenshots/logic-controller/foreach-example.png" alt="alt text"></p>
<p>先来看正则表达式提取器</p>
<p><img src="https://ers1ja.bn1.livefilestore.com/y1pDLRMxvFylmW1qmUQUvGe1DJVuwh_KUusRReatQ3QtB4ZxbWAN1HCxgqqZJnl6b9yv1rFXc8mTxe5_1LS4ji1zK4fhsRC6DWr/regular.png?psid=1" alt="alt text"></p>
<p>注意这个引用名称 <strong>inputVar</strong>， 提取出来的所有匹配值都会放在这个变量里，事实上 <strong>inputVar</strong> 相当于一个 set 了。然后我们在紧跟的 ForEach 里面使用这个变量。</p>
<p><img src="https://ers1ja.bn1.livefilestore.com/y1p1K2BOBifU6X2D6r3Ij1cXIrT_D3mwqLArS24AiUmyiIzRzAc6vkXpldU7lxAkQhCWiMmqOoV07DiBMIxJKLyDa4vpJ72qPBp/foreach.png?psid=1" alt="alt text"></p>
<p>可以看到，在 ForEach 里，我们将之前的 <strong>inputVar</strong> 设置为输入变量。然后用 <strong>returnVar</strong> 做为输出。 这其实就类似于 JAVA 里面的 ForEach。</p>
<pre><code>for(Object returnVar : inputVar) {
//process
}
</code></pre><p>这个 process 过程就是下图所示：<br><img src="https://ers1ja.bn1.livefilestore.com/y1pf_N1kVq04KkJwyA20UlawUiT_AmrnaudC6MyqCYrcnRyoer1rJXJEZM_lYgONZgC2IwH99dywgmKiVaFSUkXS3ktzbtHRZZ_/http%201.png?psid=1" alt="alt text"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/jmeter/">Jmeter</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test-china-org/">test-china.org</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-04-26-htmlunit-jie-shao" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/04/26/2013-04-26-htmlunit-jie-shao/" class="article-date">
  	<time datetime="2013-04-26T13:37:00.000Z" itemprop="datePublished">2013-04-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/04/26/2013-04-26-htmlunit-jie-shao/">HtmlUnit 介绍</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在 @Lily 的 <a href="http://test-china.org/topics/8" target="_blank" rel="external">Juint4 + WebDriver 入门篇</a> 中， Lily 问起了 HtmlUnit Driver。对 HtmlUnit Driver 我倒是没有接触太多， 所以特意去找了些文章看看。</p>
<p>在 <a href="http://code.google.com/p/selenium/wiki/HtmlUnitDriver" target="_blank" rel="external">selenium 官方 wiki</a> 上说：</p>
<blockquote>
<p>This is currently the fastest and most lightweight implementation of WebDriver. As the name suggests, this is based on HtmlUnit.</p>
</blockquote>
<p>所以想要了解 HtmlUnit Driver， 就必先追根溯源地研究下 HtmlUnit。</p>
<blockquote>
<p>HtmlUnit is a “GUI-Less browser for Java programs”. It models HTML documents and provides an API that allows you to invoke pages, fill out forms, click links, etc… just like you do in your “normal” browser.</p>
</blockquote>
<p>简单来说， HtmlUnit 就是没有界面的，你看不见的，但是却能做浏览器的活的 JAVA 版本的浏览器。需要说明的是，<strong>HtmlUnit 本身不是一个测试框架， 它真的只是一个模拟浏览器行为的程序。</strong> 所以需要和 Junit 或者 TestNG 等测试框架配合起来使用。同时，很多开源的工具也使用 HtmlUnit 来模拟浏览器行为，比如大名鼎鼎的 WebDriver。</p>
<p>下面，搬抄一把 HtmlUnit 的入门指南：</p>
<h2 id="u5EFA_u7ACB_u9879_u76EE"><a href="#u5EFA_u7ACB_u9879_u76EE" class="headerlink" title="建立项目"></a>建立项目</h2><p>使用 maven 创建一个 htmlunit 的试用项目</p>
<pre><code>mvn archetype:generate -DgroupId=com.testchina -DartifactId=my-htmlunit-test -DinteractiveMode=false
</code></pre><p>（不得不夸下 Maven， 构建的好工具啊。）</p>
<p>修改 pom.xml， 加入 HtmlUnit 依赖， 升级 Junit 为4.10。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">"http://maven.apache.org/POM/4.0.0"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">  <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="title">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>com.testchina<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>my-htmlunit-test<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="title">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>my-htmlunit-test<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="title">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="title">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="title">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="title">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>net.sourceforge.htmlunit<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>htmlunit<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="title">version</span>&gt;</span>2.10<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="title">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后，执行：</p>
<ol>
<li><code>mvn install</code></li>
<li><code>mvn eclipse:eclipse</code></li>
</ol>
<p>之后， 就可以在 eclipse 里导入项目。接着，我们来写第一个例子。</p>
<h2 id="u8BD5_u7528"><a href="#u8BD5_u7528" class="headerlink" title="试用"></a>试用</h2><p><strong>第一个例子：</strong></p>
<p>a. 访问 <a href="http://htmlunit.sourceforge.net" target="_blank" rel="external">http://htmlunit.sourceforge.net</a></p>
<p>b. 验证网页的 titile</p>
<p>c. 验证网页内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.testchina;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> com.gargoylesoftware.htmlunit.WebClient;</span><br><span class="line"><span class="keyword">import</span> com.gargoylesoftware.htmlunit.html.HtmlPage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHtmlUnitTest</span> </span>&#123;</span><br><span class="line">    <span class="annotation">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">homePage</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> WebClient webClient = <span class="keyword">new</span> WebClient(); <span class="comment">// 建立 WebClient。</span></span><br><span class="line">        <span class="keyword">final</span> HtmlPage page = webClient.getPage(<span class="string">"http://htmlunit.sourceforge.net"</span>); <span class="comment">// 访问网站，返回页面对象。</span></span><br><span class="line">        assertEquals(<span class="string">"HtmlUnit - Welcome to HtmlUnit"</span>, page.getTitleText()); <span class="comment">// 验证 title。</span></span><br><span class="line">        <span class="comment">/** 验证网页内容 */</span></span><br><span class="line">        <span class="keyword">final</span> String pageAsXml = page.asXml();</span><br><span class="line">        assertTrue(pageAsXml.contains(<span class="string">"&lt;body class=\"composite\"&gt;"</span>));</span><br><span class="line">        <span class="keyword">final</span> String pageAsText = page.asText();</span><br><span class="line">        assertTrue(pageAsText.contains(<span class="string">"Support for the HTTP and HTTPS protocols"</span>));</span><br><span class="line">        webClient.closeAllWindows();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>第二个例子: 指定浏览器</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">homePage_Firefox</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> WebClient webClient = <span class="keyword">new</span> WebClient(BrowserVersion.FIREFOX_10);</span><br><span class="line">    <span class="keyword">final</span> HtmlPage page = webClient</span><br><span class="line">            .getPage(<span class="string">"http://htmlunit.sourceforge.net"</span>);</span><br><span class="line">    assertEquals(<span class="string">"HtmlUnit - Welcome to HtmlUnit"</span>, page.getTitleText());</span><br><span class="line"></span><br><span class="line">    webClient.closeAllWindows();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很简单，在初始化 WebClient 的时候，传入浏览器版本， 目前 2.10 里面支持：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Register plugins for the browser versions. */</span></span><br><span class="line">   <span class="keyword">static</span> &#123;</span><br><span class="line">       INTERNET_EXPLORER_6.initDefaultFeatures();</span><br><span class="line">       INTERNET_EXPLORER_7.initDefaultFeatures();</span><br><span class="line">       INTERNET_EXPLORER_8.initDefaultFeatures();</span><br><span class="line"></span><br><span class="line">       FIREFOX_3.initDefaultFeatures();</span><br><span class="line">       FIREFOX_3_6.initDefaultFeatures();</span><br><span class="line">       FIREFOX_10.initDefaultFeatures();</span><br><span class="line"></span><br><span class="line">       <span class="keyword">final</span> PluginConfiguration flash = <span class="keyword">new</span> PluginConfiguration(<span class="string">"Shockwave Flash"</span>,</span><br><span class="line">           <span class="string">"Shockwave Flash 9.0 r31"</span>, <span class="string">"libflashplayer.so"</span>);</span><br><span class="line">       flash.getMimeTypes().add(<span class="keyword">new</span> PluginConfiguration.MimeType(<span class="string">"application/x-shockwave-flash"</span>,</span><br><span class="line">           <span class="string">"Shockwave Flash"</span>, <span class="string">"swf"</span>));</span><br><span class="line">       FIREFOX_3.getPlugins().add(flash);</span><br><span class="line">       FIREFOX_3_6.getPlugins().add(flash);</span><br><span class="line">       FIREFOX_10.getPlugins().add(flash);</span><br><span class="line"></span><br><span class="line">       CHROME_16.initDefaultFeatures();</span><br><span class="line">       CHROME_16.setApplicationCodeName(<span class="string">"Mozilla"</span>);</span><br><span class="line">       CHROME_16.setPlatform(<span class="string">"MacIntel"</span>);</span><br><span class="line">       CHROME_16.setCpuClass(<span class="keyword">null</span>);</span><br><span class="line">       CHROME_16.setBrowserLanguage(<span class="string">"undefined"</span>);</span><br><span class="line">       <span class="comment">// there are other issues with Chrome; a different productSub, etc.</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>第三个例子： 获取页面元素</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getElements</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> WebClient webClient = <span class="keyword">new</span> WebClient();</span><br><span class="line">    <span class="keyword">final</span> HtmlPage page = webClient.getPage(<span class="string">"http://htmlunit.sourceforge.net"</span>);</span><br><span class="line">    <span class="comment">//get list of all divs</span></span><br><span class="line">    <span class="keyword">final</span> List&lt;?&gt; divs = page.getByXPath(<span class="string">"//div"</span>); <span class="comment">// 返回所有的div</span></span><br><span class="line">    System.out.println(((HtmlDivision)divs.get(<span class="number">0</span>)).asText()); <span class="comment">// 得到第一个 Div 节点的内容。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 返回所有的超链接， 并打印 name 属性*/</span></span><br><span class="line">    <span class="keyword">final</span> List&lt;HtmlAnchor&gt; anchors = page.getAnchors();</span><br><span class="line">    <span class="keyword">for</span> (HtmlAnchor anchor : anchors) &#123;</span><br><span class="line">        System.out.println(anchor.getAttribute(<span class="string">"name"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    webClient.closeAllWindows();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>第四个例子： 提交表单</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">submittingForm</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> WebClient webClient = <span class="keyword">new</span> WebClient();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the first page</span></span><br><span class="line">    <span class="keyword">final</span> HtmlPage page1 = webClient.getPage(<span class="string">"http://some_url"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the form that we are dealing with and within that form,</span></span><br><span class="line">    <span class="comment">// find the submit button and the field that we want to change.</span></span><br><span class="line">    <span class="keyword">final</span> HtmlForm form = page1.getFormByName(<span class="string">"myform"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> HtmlSubmitInput button = form.getInputByName(<span class="string">"submitbutton"</span>);</span><br><span class="line">    <span class="keyword">final</span> HtmlTextInput textField = form.getInputByName(<span class="string">"userid"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Change the value of the text field</span></span><br><span class="line">    textField.setValueAttribute(<span class="string">"root"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Now submit the form by clicking the button and get back the second page.</span></span><br><span class="line">    <span class="keyword">final</span> HtmlPage page2 = button.click();</span><br><span class="line"></span><br><span class="line">    webClient.closeAllWindows();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>是不是很棒？ 所有浏览器能做的，它都能做，我们再来看下它的特性：</p>
<ul>
<li>支持 HTTP and HTTPS 协议</li>
<li>支持 cookies</li>
<li>支持 Post， Get， Head， Delete</li>
<li>支持代理</li>
<li>能分析 HTTP responses</li>
<li>能自定义 HTTP request head</li>
<li>支持 Javascript</li>
</ul>
<p>于是有<br><strong>第五个例子： 使用 javascript</strong></p>
<p>这里的 Javascript 的意思，是指 HtmlUnit 可以通过 js 引擎执行 javascript 代码。</p>
<blockquote>
<p>HtmlUnit provides excellent JavaScript support, simulating the behavior of the configured browser (Firefox or Internet Explorer). It uses the Rhino JavaScript engine for the core language (plus workarounds for some Rhino bugs) and provides the implementation for the objects specific to execution in a browser.</p>
</blockquote>
<p>比如我们的页面有一个 alert 事件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span><span class="tag">&lt;<span class="title">head</span>&gt;</span><span class="tag">&lt;<span class="title">title</span>&gt;</span>Alert sample<span class="tag">&lt;/<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">onload</span>=<span class="value">'alert("foo");'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们如何捕捉它呢？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">alerts</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> WebClient webClient = <span class="keyword">new</span> WebClient();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> List collectedAlerts = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    webClient.setAlertHandler(<span class="keyword">new</span> CollectingAlertHandler(collectedAlerts));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Since we aren't actually manipulating the page, we don't assign</span></span><br><span class="line">    <span class="comment">// it to a variable - it's enough to know that it loaded.</span></span><br><span class="line">    webClient.getPage(<span class="string">"http://tciludev01/test.html"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> List expectedAlerts = Collections.singletonList(<span class="string">"foo"</span>);</span><br><span class="line">    assertEquals(expectedAlerts, collectedAlerts);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是不是很轻巧？ 像真正的浏览器一样， HtmlUnit 可以响应各种 Javascript 事件， 执行各种 Javascript 代码。</p>
<hr>
<p>对于 HtmlUnit， 我就初略看了看， 总的印象是轻，不用启动笨重的浏览器就能做到和浏览器一样的行为， 和 Junit4 很好的搭配，可以<br>写出轻巧优美的测试案例， 同时也能为测试省去不少时间。这在前期测试驱动开发的时候，特别是 Web 应用开发，可以节省去不少时间。</p>
<p>参见:</p>
<p><a href="http://htmlunit.sourceforge.net/" target="_blank" rel="external">http://htmlunit.sourceforge.net/</a></p>
<p><a href="http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html" target="_blank" rel="external">http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html</a></p>
<p><a href="http://code.google.com/p/selenium/wiki/HtmlUnitDriver" target="_blank" rel="external">http://code.google.com/p/selenium/wiki/HtmlUnitDriver</a></p>
<p><a href="http://htmlunit.sourceforge.net/javascript-howto.html" target="_blank" rel="external">http://htmlunit.sourceforge.net/javascript-howto.html</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test-china-org/">test-china.org</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-03-21-windowsxia-cha-zhao-zhan-yong-duan-kou-de-jin-cheng" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/03/21/2013-03-21-windowsxia-cha-zhao-zhan-yong-duan-kou-de-jin-cheng/" class="article-date">
  	<time datetime="2013-03-21T13:02:00.000Z" itemprop="datePublished">2013-03-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/21/2013-03-21-windowsxia-cha-zhao-zhan-yong-duan-kou-de-jin-cheng/">windows 下查找占用端口的进程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>一直只知道 *nux 下的命令，对 windows 知之甚少，其实 windows 下也有很多强大的命令。</p>
<p>比如在 linux 下查看一个 mysql 的端口，</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">➜  octopress git:(source) ✗ netstat -an | grep <span class="number">3306</span> <span class="preprocessor"># mac 下的命令没有 linux 下来的丰富啊，没有 p 选项。</span></span><br><span class="line">tcp4       <span class="number">0</span>      <span class="number">0</span>  *<span class="number">.3306</span>                 *.*                    LISTEN</span><br><span class="line"></span><br><span class="line">root@li493-<span class="number">58</span>:~<span class="preprocessor"># netstat -anp | grep <span class="number">3306</span> # 这是 ubuntu 下面的。</span></span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">3306</span>            <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:*               LISTEN      <span class="number">2509</span>/mysqld</span><br></pre></td></tr></table></figure>
<p>很方便吧。那么如果在 windows 下呢？</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">netstat -ano | findstr <span class="number">3306</span> <span class="preprocessor"># 这里会把 pid 告诉你，比如 pid 是 <span class="number">1278</span></span></span><br><span class="line"></span><br><span class="line">tasklist /fi <span class="string">"pid eq 1278"</span> <span class="preprocessor"># 这样就找到了 <span class="number">1278</span> 对应的进程</span></span><br></pre></td></tr></table></figure>
<p>也是很简单的吧！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/windows/">windows</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-03-15-8atmyhouse" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/03/15/2013-03-15-8atmyhouse/" class="article-date">
  	<time datetime="2013-03-15T14:18:00.000Z" itemprop="datePublished">2013-03-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/03/15/2013-03-15-8atmyhouse/">8atmyHouse</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我工作 6 年。 2 年徐汇， 2 年 黄浦， 2 年 浦东。我住宝山区。我从一开始的愿望就是能踏着晨光上班，踩着夕阳下班。<br>从来或者很少实现。有几次生病的下午，实在顶不住，请假回家，当地铁从地下穿入高空的时候，晴脆的阳光撒进车厢，我就想<br>什么时候我可以不用朝九晚六。</p>
<p>8 at my house 说起来有段历史。2009 年，我在 DE 项目工作，8atmyHouse 就是这个项目的一个公用密码，很忙，每个人都希望<br>晚上八点能到家。不知道别人怎样，反正我能刚刚好，想起来在 google 上海的那段时间算得上是我职业生涯最快活的一段了。</p>
<p>离开之后，去了更远的张江集电港的 AMD， 每天 6 点出门，晚上 9 点到家。早上刮的干净的脸庞，晚上已胡子拉渣。除了感叹上海之大之外，<br>也恨宝山怎么没有高科技。三个月之后实在受不了，投了几份简历之后，有幸去了稍微近一点的浦东南路的智涌。上班一个小半时，下班一个半小时，<br>每天在跨越整个上海，从浦西到浦东，放在过去，就是每天去上海上班。</p>
<p>我到智涌后，也沿袭了 8atmyHouse 做密码的习惯。同事总会问， 为什么用这个密码，我说希望八点能在家坐在沙发上看看电视看看书。他们又会问，<br>能行么？我说看运气，如果永远踩着点，不落下任何一班车，那晚上8点半的时候，我可以坐在家里的电脑前。否则那八成还在回家的路上。同事问的多了，<br>后来连老板也调侃我，比如最近夏令时了，是不是应该改成 7atmyHouse 。我其实想说这不是都靠老板你了么？</p>
<p>八点在家，说起来是多么容易的事情啊，这 6 年却有几次？也许再有猎头找我的时候，我一定告诉他，我要求不高，8 at my home!</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/生活杂记/">生活杂记</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-02-12-shi-yong-capybara-deng-lu-bai-du" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/02/12/2013-02-12-shi-yong-capybara-deng-lu-bai-du/" class="article-date">
  	<time datetime="2013-02-12T09:14:00.000Z" itemprop="datePublished">2013-02-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/02/12/2013-02-12-shi-yong-capybara-deng-lu-bai-du/">使用 capybara 登陆百度</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>ShiLongLu 问你有什么办法测试百度的登录窗口呢？这是差不多2个月前的问题了，我一直忙于 Dota 圣剑传说。恰巧春节有时间看了下。</p>
<p>百度登陆的时候是弹出一个对话框，如图：</p>
<p><img src="/photos/baidulogin.png" alt=""></p>
<p>但是这个对话框是用 iframe 实现的。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">iframe</span> <span class="attribute">height</span>=<span class="value">"100%"</span> <span class="attribute">frameborder</span>=<span class="value">"0"</span> <span class="attribute">width</span>=<span class="value">"100%"</span> <span class="attribute">scrolling</span>=<span class="value">"no"</span> <span class="attribute">src</span>=<span class="value">"http://www.baidu.com/cache/user/html/login-1.2.html"</span> <span class="attribute">marginheight</span>=<span class="value">"0"</span> <span class="attribute">marginwidth</span>=<span class="value">"0"</span> <span class="attribute">id</span>=<span class="value">"login_iframe"</span>&gt;</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="title">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>所以在填写用户名和密码的时候，需要先 switch 到这个 frame 上去， </p>
<blockquote>
<p>When working inside a frame, you should use Capybara’s within_frame method.</p>
<ul>
<li>(Object) within_frame(frame_id)</li>
</ul>
<p>Execute the given block within the given iframe given the id of that iframe. Only works on some drivers (e.g. Selenium)</p>
<p>Parameters:<br>frame_id (String) — Id of the frame</p>
</blockquote>
<p>所以我们的实现基本如下：</p>
<p>baidu.feature:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">Given</span> <span class="constant">I</span> am on baidu.com</span><br><span class="line"><span class="constant">When</span> <span class="constant">I</span>  click <span class="string">"登录"</span></span><br><span class="line"><span class="constant">And</span> <span class="constant">I</span> switch to login form</span><br><span class="line"><span class="constant">And</span> <span class="constant">I</span> enter <span class="string">"lihuazhang@hotmail.com"</span> <span class="keyword">for</span> <span class="string">"帐号"</span></span><br><span class="line"><span class="constant">And</span> <span class="constant">I</span> enter <span class="string">"204646"</span> <span class="keyword">for</span> <span class="string">"密码"</span></span><br><span class="line"><span class="constant">And</span> <span class="constant">I</span> click <span class="string">"登录"</span> button</span><br><span class="line"><span class="constant">Then</span> <span class="constant">I</span> should see <span class="string">"zhangzuichi"</span></span><br></pre></td></tr></table></figure>
<p>step_definition.rb:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">When</span> /^<span class="constant">I</span> enter <span class="string">"(.*?)"</span> <span class="keyword">for</span> <span class="string">"(.*?)"</span><span class="variable">$/</span> <span class="keyword">do</span> |value, key|</span><br><span class="line">  <span class="keyword">if</span> key == <span class="string">"帐号"</span></span><br><span class="line">    within_frame <span class="string">'login_iframe'</span> <span class="keyword">do</span></span><br><span class="line">      fill_in <span class="string">'pass_login_username_0'</span>, <span class="symbol">:with</span> =&gt; value</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">     within_frame <span class="string">'login_iframe'</span> <span class="keyword">do</span></span><br><span class="line">      fill_in <span class="string">'pass_login_password_0'</span>, <span class="symbol">:with</span> =&gt; value</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">When</span> /^<span class="constant">I</span> click <span class="string">"(.*?)"</span> button<span class="variable">$/</span> <span class="keyword">do</span> |arg1|</span><br><span class="line">  within_frame <span class="string">'login_iframe'</span> <span class="keyword">do</span></span><br><span class="line">    click_button <span class="string">'pass_login_input_submit_0'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>大致如此，在 firefox 下测试通过。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/capybara/">Capybara</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2013-02-12-gao-bie-2012" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/02/12/2013-02-12-gao-bie-2012/" class="article-date">
  	<time datetime="2013-02-12T02:57:00.000Z" itemprop="datePublished">2013-02-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2013/02/12/2013-02-12-gao-bie-2012/">告别2012</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>2011年6月我离开AMD，进入现在这家公司，转眼2年快过去了。现在每次和同事聊起来，都觉得其实现在的这家公司很亏。<br>我们几乎所有的员工在这里都完成了各自人生的大事。比如结婚，比如生子，比如怀孕。到了我这种年纪的人事业慢慢靠边站，<br>婚姻家庭走上舞台。这或多或少的对公司总会有点影响。</p>
<p>2012年9月中旬，和小顾去香港兜了一圈。<br>2012年10月1日，我在家里操办了婚宴。之后和小顾开始了两人生活。<br>2012年11月，报名练车。<br>2012年12月，练车。<br>2013年1月，去北京兜了一圈。加练车。<br>2013年2月，小顾小路过了。我还没考。过春节。  </p>
<p>公司比起2011年来更加不景气，美国裁员之后，真正做事的都走了，剩下一些开会和管事的人。上海部门和美国的沟通也越发的困难，我们从本来的一个研发部门变成了一个信息孤岛，彻底成了美国总部的一个外包。大家抱怨的声音也越来越大，头儿们也不知道如何安慰。春节房间前， Jacky 提出了离职，大家唏嘘不已。</p>
<p>业余时间做的游戏不好不坏，在这里打个广告，<a href="http://dota.baicaisi.net" target="_blank" rel="external">Doat 圣剑传说</a>, android 和 ios 同步发布。</p>
<p><img src="http://dota.baicaisi.net/images/screenshots/2.png" alt=""></p>
<p>瞧着不错吧！欢迎大家试玩，也希望大家能帮忙宣传下，我们不会做营销，只有口口相传的用户。当然口碑不错。</p>
<p>2012年，过得不好不坏，咋一想，啥也回忆不起来，唯有那次在北京滑雪，从山顶一冲而下的光景。</p>
<p><img src="/photos/huaxue.jpg" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/生活杂记/">生活杂记</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/08/06/2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong/" class="article-date">
  	<time datetime="2012-08-06T13:58:00.000Z" itemprop="datePublished">2012-08-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/08/06/2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong/">映射 Windows cmd 可以读取的磁盘驱动</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在 windows 下， 通常我们映射一个网路驱动到本地的时候， 会在本地生成一个文件夹与之映射。<br>然后我们就可以通过这个文件夹访问和操作资源（当然你得有权限），好像操作本地文件一样。但是这样，<br>似乎就不能通过命令行访问。（不知道为什么，但是最近遇到这个问题）</p>
<p>贴出解决方法：</p>
<p><em>1.</em> 进入命令行窗口。</p>
<blockquote>
<p>使用 Alt + F2， 然后输入 cmd， 回车。 或者从开始菜单，运行那里输入cmd，回车。</p>
</blockquote>
<p><em>2.</em> 输入<code>net use X: \\path\to\share</code>， X 是你要映射的盘符， \path\to\share 就是你的网络驱动地址。</p>
<p><em>3.</em> 回车，然后成功~</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/windows/">windows</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2012-08-05-surround-dot-vim" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/08/05/2012-08-05-surround-dot-vim/" class="article-date">
  	<time datetime="2012-08-05T01:37:00.000Z" itemprop="datePublished">2012-08-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/08/05/2012-08-05-surround-dot-vim/">surround.vim</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>一般写东西的时候，总会遇到比如写了一长串文字后，突然想给这串文字头尾加个括号，<br>或者引号。其实很多编辑器都提供这种功能，选中，然后输入括号。但是一直用 Vim，也没发现<br>有这种功能， 也只能怪自己没有研究。 后来网上找了一圈， 发现了原来有这个插件： <a href="https://github.com/tpope/vim-surround/">surround.vim</a>。</p>
<blockquote>
<p>Surround.vim is all about “surroundings”: parentheses, brackets, quotes, XML tags, and more. The plugin provides mappings to easily delete, change and add such surroundings in pairs.</p>
</blockquote>
<p>先看下全部的快捷键：</p>
<p><img src="/photos/allkey.png" alt=""></p>
<p>可以看到基本有三种操作：</p>
<ul>
<li>删除</li>
</ul>
<p>ds 加包在两边的引号，括号或者标签（标签全部用t代替）。</p>
<p>e.g:</p>
<p>“hello, world!” =&gt; hello, world! 只要输入 <code>ds&quot;</code></p>
<p>\<strong\>hello, world!\</strong\> =&gt; hello, world! 只要输入 <code>dst</code></p>
<ul>
<li>添加</li>
</ul>
<p><img src="/photos/addkey.png" alt=""></p>
<p>note: s 代表sentence iw/w 代表 word。</p>
<ul>
<li>修改</li>
</ul>
<p><img src="/photos/changekey.png" alt=""></p>
<p>截图来自<a href="http://ihacklog.com/post/vim-plugins-you-should-know-about-surround.html">你应该知道的vim插件之surround.vim</a></p>
<p>到此， surround vim 你就基本掌握了。 如果你对这些快捷键能倒敲入流，那么你一定能得到许多的便捷。 XD</p>
<p>扩展阅读： Text Object<br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/vim/">Vim</a>
	</div>


      
      
        <p class="article-more-link">
          <a  href="/2012/08/05/2012-08-05-surround-dot-vim/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2012-04-25-webdriver-4-jia-shang-xie-zi" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/25/2012-04-25-webdriver-4-jia-shang-xie-zi/" class="article-date">
  	<time datetime="2012-04-25T12:52:00.000Z" itemprop="datePublished">2012-04-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/25/2012-04-25-webdriver-4-jia-shang-xie-zi/">WebDriver 4: 加上叶子</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在前三篇WebDriver文章里，我们基本上有了一个Maven WebDriver Junit4的框架主干，这些还远远不够。<br>所以我们要添些叶子。</p>
<ul>
<li>要有资源配置文件</li>
<li>要有WebDriver的封装</li>
<li>要有业务对象的抽象，比如用户</li>
<li>要有自定义的异常</li>
</ul>
<p>我们大概期望有这样的文件架构：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── main</span><br><span class="line">│   ├── java</span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.exception</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.model</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.page</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.utils</span></span><br><span class="line">│   └── resources</span><br><span class="line">└── test</span><br><span class="line">    ├── java</span><br><span class="line">    │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.testcase</span></span><br><span class="line">    └── resources</span><br></pre></td></tr></table></figure>
<hr>
<p>###配置文件</p>
<p>Maven 有自己的资源文件管理策略，我们只需要修改之前的pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">"http://maven.apache.org/POM/4.0.0"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">    <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="title">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">testResources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">testResource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/test/resources<span class="tag">&lt;/<span class="title">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">testResource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">testResources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">build</span>&gt;</span> </span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们指定了两个资源文件目录，然后将config.xml放在这些目录之下。<br><em>注意，src/main/resouces下的文件只能在运行main里面的代码的时候才会用到，同样的src/test/resources下的配置文件只有在运行测试的时候才会加载。</em></p>
<p>可以将<strong>浏览器类型, 远程服务器地址, 应用URL之类</strong>放到config.xml中去。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">config</span> <span class="attribute">id</span>=<span class="value">"config"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">BaseUrl</span>&gt;</span>http://www.baidu.com<span class="tag">&lt;/<span class="title">BaseUrl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">Browser</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">type</span>&gt;</span>Firefox10<span class="tag">&lt;/<span class="title">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">location</span>&gt;</span>pathToBrowser<span class="tag">&lt;/<span class="title">location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">remote</span>&gt;</span>192.168.1.248<span class="tag">&lt;/<span class="title">remote</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">Browser</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">user</span> <span class="attribute">name</span>=<span class="value">"xxx"</span> <span class="attribute">password</span>=<span class="value">"xxx"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">config</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
    <article id="post-2012-04-24-sauce-ondemandshi-yong" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/24/2012-04-24-sauce-ondemandshi-yong/" class="article-date">
  	<time datetime="2012-04-24T13:37:00.000Z" itemprop="datePublished">2012-04-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/24/2012-04-24-sauce-ondemandshi-yong/">Sauce OnDemand试用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>闲着无聊，试用了下<a href="https://saucelabs.com" target="_blank" rel="external">saucelabs</a>。<br>先注册用户，这个略过不说。</p>
<p>saucelabs有两种方式:</p>
<ol>
<li><p>Sauce Scout</p>
<p> 通过访问架在云端的浏览器(cloud-hosted browsers)执行测试用例。相当于saucelabs给用户提供了多种多样组合的虚拟机，只不过这个虚拟机就只有一个浏览器。如图：<br> <img src="/photos/soucescout.png" alt="sourcescout" title="soucescout"></p>
<p> Saucelabs提供了许多方案，对于那些没有空间部署环境的公司，这个服务的确很贴心。</p>
</li>
<li><p>Sauce OnDemand</p>
<p> Sauce OnDemand就是所谓的自动化了。我们利用WebDriver或者Selenium RC的remote server来指定SauceLabs提供的浏览器配置，进行各种自动化测试。</p>
</li>
</ol>
<p>那我们开始试用Sauce OnDemand，英语好的攻城狮们请直接移步<a href="https://saucelabs.com/docs/ondemand/getting-started/env/ruby/se2/linux" target="_blank" rel="external">Get Started</a></p>
<p>为了方便起见，我就用ruby。首先确保你安装了<code>selenium-webdriver</code>，如果没有安装，在终端用以下命令安装：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="keyword">install</span> selenium-webdriver</span><br></pre></td></tr></table></figure></p>
<p>输入以下代码：注意: 代码中的:url请替换成你自己的，不过我不知道这个url到底是哪里来的，<br>我是从get started里面的例子里找到的。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'rubygems'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"test/unit"</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'selenium-webdriver'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="inheritance">&lt; <span class="parent">Test::Unit</span></span>::<span class="title">TestCase</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup</span></span></span><br><span class="line">        caps = <span class="constant">Selenium::WebDriver::Remote::Capabilities</span>.firefox</span><br><span class="line">        caps.version = <span class="string">"5"</span></span><br><span class="line">        caps.platform = <span class="symbol">:XP</span></span><br><span class="line">        caps[<span class="symbol">:name</span>] = <span class="string">"Testing Selenium 2 with Ruby on Sauce"</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">@driver</span> = <span class="constant">Selenium::WebDriver</span>.<span class="keyword">for</span>(</span><br><span class="line">          <span class="symbol">:remote</span>,</span><br><span class="line">          <span class="symbol">:url</span> =&gt; <span class="string">"http://lihuazhang:ba444e83-206c-4a9c-b008-4da920d7f852@ondemand.saucelabs.com:80/wd/hub"</span>,</span><br><span class="line">          <span class="symbol">:desired_capabilities</span> =&gt; caps)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sauce</span></span></span><br><span class="line">        <span class="variable">@driver</span>.navigate.to <span class="string">"http://saucelabs.com/test/guinea-pig"</span></span><br><span class="line">        assert <span class="variable">@driver</span>.title.<span class="keyword">include</span>?(<span class="string">"I am a page title - Sauce Labs"</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown</span></span></span><br><span class="line">        <span class="variable">@driver</span>.quit</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>运行<code>ruby basic-example.rb</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Run options: </span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">Finished tests in <span class="number">44.647462</span>s, <span class="number">0.0224</span> tests/s, <span class="number">0.0224</span> assertions/s.</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> tests, <span class="number">1</span> assertions, <span class="number">0</span> failures, <span class="number">0</span> errors, <span class="number">0</span> skips</span><br></pre></td></tr></table></figure>
<p>可以看到运行成功，我们再去sauce的<a href="https://saucelabs.com/account" target="_blank" rel="external">Account</a>页面里去看下运行的结果。</p>
<p><img src="/photos/souceaccount.png" alt="account"></p>
<p>可以看到页面里有video和log下载，打开log我们可以看到运行的录像，而log就记录了运行的信息。<br>此外，我们更可以点开测试用例，查看更多的细节。</p>
<p>但是一般我们测试环境都是内网，为了满足这个条件，Saucelabs提供一条通道叫Sauce Connect。</p>
<blockquote>
<p>Sauce Connect creates a secure and reliable tunnel from our cloud to your private network that can only be accessed by you. This eliminates the need to whitelist IPs, open any ports on your firewall or go through any changes in your tests.<br>Sauce Connect is not only for accessing private servers. If you want all of your test traffic to be secure and reliable, even the Selenium instructions you send to Sauce, you can use Sauce Connect for that too!</p>
</blockquote>
<h2 id="Get_Started_3A"><a href="#Get_Started_3A" class="headerlink" title="Get Started:"></a>Get Started:</h2><p>1.先下载<a href="https://saucelabs.com/downloads/Sauce-Connect-latest.zip" target="_blank" rel="external">Sauce Connect</a></p>
<p>2.解压然后运行<code>java -jar Sauce-Connect.jar lihuazhang ba444e83-206c-4a9c-b008-4da920d7f852</code></p>
<ol>
<li>确定tunnel start以后，接下去你就可以运行你的测试用例了。</li>
</ol>
<p>我们再来看下刚刚那个测试用例，让程序navigate.to到本地。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'rubygems'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"test/unit"</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'selenium-webdriver'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="inheritance">&lt; <span class="parent">Test::Unit</span></span>::<span class="title">TestCase</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup</span></span></span><br><span class="line">        caps = <span class="constant">Selenium::WebDriver::Remote::Capabilities</span>.firefox</span><br><span class="line">        caps.version = <span class="string">"5"</span></span><br><span class="line">        caps.platform = <span class="symbol">:XP</span></span><br><span class="line">        caps[<span class="symbol">:name</span>] = <span class="string">"Testing Selenium 2 with Ruby on Sauce"</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">@driver</span> = <span class="constant">Selenium::WebDriver</span>.<span class="keyword">for</span>(</span><br><span class="line">          <span class="symbol">:remote</span>,</span><br><span class="line">          <span class="symbol">:url</span> =&gt; <span class="string">"http://lihuazhang:ba444e83-206c-4a9c-b008-4da920d7f852@ondemand.saucelabs.com:80/wd/hub"</span>,</span><br><span class="line">          <span class="symbol">:desired_capabilities</span> =&gt; caps)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sauce</span></span></span><br><span class="line">        <span class="variable">@driver</span>.navigate.to <span class="string">"http://localhost:3000"</span> <span class="comment"># Set a local env.</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown</span></span></span><br><span class="line">        <span class="variable">@driver</span>.quit</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>再运行一遍，必然成功啊~</p>
<p>我们看下Sauce-Connect.jar的日志，可以看到这个tunnel起到了一个中转的作用。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">01</span>,<span class="number">184</span> - connection to Sauce Connect server closed</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">01</span>,<span class="number">927</span> - old keepalive timer shutting down</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">03</span>,<span class="number">923</span> - Successful handshake with Sauce Connect server</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">03</span>,<span class="number">927</span> - resending <span class="number">2</span> packets</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">04</span>,<span class="number">078</span> - Tunnel host version: <span class="number">0.1</span><span class="number">.0</span>, remote endpoint ID: <span class="number">73</span>b1e202231b41a3802aab8785caf15f</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">002</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">003</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">007</span> - Could not proxy /, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">145</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">147</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/favicon.ico</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">148</span> - Could not proxy /favicon.ico, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">589</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">592</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/favicon.ico</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">594</span> - Could not proxy /favicon.ico, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">23</span>,<span class="number">391</span> - GET http:<span class="comment">//feeds.bbci.co.uk/news/rss.xml?edition=int -&gt; 200 (2847ms)</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">53</span>,<span class="number">084</span> - disconnected from Sauce Connect server</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">53</span>,<span class="number">085</span> - connection to Sauce Connect server closed</span><br></pre></td></tr></table></figure>
<p>同样的，我们可以在Account里面看到这个测试用例的运行细节，如图：</p>
<p><img src="/photos/sauce_detail1.png" alt="detail"></p>
<p><img src="/photos/sauce_detail2.png" alt="detail"></p>
<p>不错吧，有兴趣，自己动手试试。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     

  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2015 恒温
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >本站到访数: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, 本页阅读量: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    
	<script>
		var yiliaConfig = {
			fancybox: false,
			mathjax: true,
			animate: true,
			isHome: true,
			isPost: false,
			isArchive: false,
			isTag: false,
			isCategory: false,
			open_in_new: false
		}
	</script>


<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>