<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>八点下班</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta property="og:type" content="website">
<meta property="og:title" content="八点下班">
<meta property="og:url" content="http://8atmyhouse.com/page/4/index.html">
<meta property="og:site_name" content="八点下班">
<meta property="og:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八点下班">
<meta name="twitter:description" content="其实一直是想晚上八点能在家，但是现在下班也是种奢望。">
  
    <link rel="alternative" href="/atom.xml" title="八点下班" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  <div id="top"></div>
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">恒温</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/about/">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/metro/" style="font-size: 10px;">Metro</a> <a href="/tags/capybara/" style="font-size: 17.5px;">capybara</a> <a href="/tags/cucumber/" style="font-size: 15px;">cucumber</a> <a href="/tags/factory-gril/" style="font-size: 10px;">factory_gril</a> <a href="/tags/git/" style="font-size: 12.5px;">git</a> <a href="/tags/nexus-7-2013/" style="font-size: 10px;">nexus 7 2013</a> <a href="/tags/pageobject/" style="font-size: 12.5px;">pageobject</a> <a href="/tags/test-china-org/" style="font-size: 20px;">test-china.org</a> <a href="/tags/vim/" style="font-size: 12.5px;">vim</a> <a href="/tags/xpath/" style="font-size: 10px;">xpath</a> <a href="/tags/南京/" style="font-size: 10px;">南京</a> <a href="/tags/性能测试/" style="font-size: 10px;">性能测试</a> <a href="/tags/游戏开发/" style="font-size: 10px;">游戏开发</a> <a href="/tags/翻译/" style="font-size: 10px;">翻译</a> <a href="/tags/陆犯焉识/" style="font-size: 10px;">陆犯焉识</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">平和而有力量</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">恒温</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">恒温</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/about/">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/lihuazhang" title="Twitter"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/08/06/2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong/" class="article-date">
  	<time datetime="2012-08-06T13:58:00.000Z" itemprop="datePublished">2012-08-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/08/06/2012-08-06-ying-she-windows-cmdke-yi-du-qu-de-ci-pan-qu-dong/">映射 Windows cmd 可以读取的磁盘驱动</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在 windows 下， 通常我们映射一个网路驱动到本地的时候， 会在本地生成一个文件夹与之映射。<br>然后我们就可以通过这个文件夹访问和操作资源（当然你得有权限），好像操作本地文件一样。但是这样，<br>似乎就不能通过命令行访问。（不知道为什么，但是最近遇到这个问题）</p>
<p>贴出解决方法：</p>
<p><em>1.</em> 进入命令行窗口。</p>
<blockquote>
<p>使用 Alt + F2， 然后输入 cmd， 回车。 或者从开始菜单，运行那里输入cmd，回车。</p>
</blockquote>
<p><em>2.</em> 输入<code>net use X: \\path\to\share</code>， X 是你要映射的盘符， \path\to\share 就是你的网络驱动地址。</p>
<p><em>3.</em> 回车，然后成功~</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/windows/">windows</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-08-05-surround-dot-vim" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/08/05/2012-08-05-surround-dot-vim/" class="article-date">
  	<time datetime="2012-08-05T01:37:00.000Z" itemprop="datePublished">2012-08-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/08/05/2012-08-05-surround-dot-vim/">surround.vim</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>一般写东西的时候，总会遇到比如写了一长串文字后，突然想给这串文字头尾加个括号，<br>或者引号。其实很多编辑器都提供这种功能，选中，然后输入括号。但是一直用 Vim，也没发现<br>有这种功能， 也只能怪自己没有研究。 后来网上找了一圈， 发现了原来有这个插件： <a href="https://github.com/tpope/vim-surround/">surround.vim</a>。</p>
<blockquote>
<p>Surround.vim is all about “surroundings”: parentheses, brackets, quotes, XML tags, and more. The plugin provides mappings to easily delete, change and add such surroundings in pairs.</p>
</blockquote>
<p>先看下全部的快捷键：</p>
<p><img src="/photos/allkey.png" alt=""></p>
<p>可以看到基本有三种操作：</p>
<ul>
<li>删除</li>
</ul>
<p>ds 加包在两边的引号，括号或者标签（标签全部用t代替）。</p>
<p>e.g:</p>
<p>“hello, world!” =&gt; hello, world! 只要输入 <code>ds&quot;</code></p>
<p>\<strong\>hello, world!\</strong\> =&gt; hello, world! 只要输入 <code>dst</code></p>
<ul>
<li>添加</li>
</ul>
<p><img src="/photos/addkey.png" alt=""></p>
<p>note: s 代表sentence iw/w 代表 word。</p>
<ul>
<li>修改</li>
</ul>
<p><img src="/photos/changekey.png" alt=""></p>
<p>截图来自<a href="http://ihacklog.com/post/vim-plugins-you-should-know-about-surround.html">你应该知道的vim插件之surround.vim</a></p>
<p>到此， surround vim 你就基本掌握了。 如果你对这些快捷键能倒敲入流，那么你一定能得到许多的便捷。 XD</p>
<p>扩展阅读： Text Object<br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/vim/">Vim</a>
	</div>


      
      
        <p class="article-more-link">
          <a  href="/2012/08/05/2012-08-05-surround-dot-vim/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-08-01-xiao-qing-xin-outlookshi-yong-ji" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/08/01/2012-08-01-xiao-qing-xin-outlookshi-yong-ji/" class="article-date">
  	<time datetime="2012-08-01T12:52:00.000Z" itemprop="datePublished">2012-08-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/08/01/2012-08-01-xiao-qing-xin-outlookshi-yong-ji/">小清新 Outlook 试用记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>我不得不说，outlook 不错。Metro 风格像清新的风让人觉得惬意。目前 outlook 提供从 hotmail 升级和注册新用户两种方式。</p>
<p>登入<a href="http://www.hotmail.com">Hotmail</a>，</p>
<p><img src="/photos/hotmail.png"></img></p>
<p>点击<strong>了解详情</strong>， 进入<strong>Outlook 预览</strong>页面</p>
<p><img src="/photos/outlookpreview.png"></img></p>
<p>点击<strong>试用 Outlook</strong>进入注册页面，在这个页面你可以试用原先的 hotmail 邮箱，也可以注册一个新的 outlook 的邮箱。</p>
<p><img src="/photos/register.png"></img></p>
<p>我将我的 hotmail 升级了一把。然后登陆 outlook， 登陆之后的界面：</p>
<p><img src="/photos/main.png"></img></p>
<p>很棒吧！ 干净清爽！</p>
<p>用半小时粗略的试用了 outlook 的各种功能。为之倾倒，不吝言辞，我来说几句。</p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/windows/">windows</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/metro/">Metro</a></li></ul>
	</div>

      
        <p class="article-more-link">
          <a  href="/2012/08/01/2012-08-01-xiao-qing-xin-outlookshi-yong-ji/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-25-webdriver-4-jia-shang-xie-zi" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/25/2012-04-25-webdriver-4-jia-shang-xie-zi/" class="article-date">
  	<time datetime="2012-04-25T12:52:00.000Z" itemprop="datePublished">2012-04-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/25/2012-04-25-webdriver-4-jia-shang-xie-zi/">WebDriver 4: 加上叶子</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在前三篇WebDriver文章里，我们基本上有了一个Maven WebDriver Junit4的框架主干，这些还远远不够。<br>所以我们要添些叶子。</p>
<ul>
<li>要有资源配置文件</li>
<li>要有WebDriver的封装</li>
<li>要有业务对象的抽象，比如用户</li>
<li>要有自定义的异常</li>
</ul>
<p>我们大概期望有这样的文件架构：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── main</span><br><span class="line">│   ├── java</span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.exception</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.model</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.page</span></span><br><span class="line">│   │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.utils</span></span><br><span class="line">│   └── resources</span><br><span class="line">└── test</span><br><span class="line">    ├── java</span><br><span class="line">    │   └── com<span class="class">.ahchoo</span><span class="class">.automation</span><span class="class">.testcase</span></span><br><span class="line">    └── resources</span><br></pre></td></tr></table></figure>
<hr>
<p>###配置文件</p>
<p>Maven 有自己的资源文件管理策略，我们只需要修改之前的pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">project</span> <span class="attribute">xmlns</span>=<span class="value">"http://maven.apache.org/POM/4.0.0"</span> <span class="attribute">xmlns:xsi</span>=<span class="value">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">    <span class="attribute">xsi:schemaLocation</span>=<span class="value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="title">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="title">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">testResources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">testResource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="title">directory</span>&gt;</span>src/test/resources<span class="tag">&lt;/<span class="title">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="title">testResource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">testResources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">build</span>&gt;</span> </span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们指定了两个资源文件目录，然后将config.xml放在这些目录之下。<br><em>注意，src/main/resouces下的文件只能在运行main里面的代码的时候才会用到，同样的src/test/resources下的配置文件只有在运行测试的时候才会加载。</em></p>
<p>可以将<strong>浏览器类型, 远程服务器地址, 应用URL之类</strong>放到config.xml中去。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">config</span> <span class="attribute">id</span>=<span class="value">"config"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">BaseUrl</span>&gt;</span>http://www.baidu.com<span class="tag">&lt;/<span class="title">BaseUrl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">Browser</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">type</span>&gt;</span>Firefox10<span class="tag">&lt;/<span class="title">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">location</span>&gt;</span>pathToBrowser<span class="tag">&lt;/<span class="title">location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">remote</span>&gt;</span>192.168.1.248<span class="tag">&lt;/<span class="title">remote</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">Browser</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">user</span> <span class="attribute">name</span>=<span class="value">"xxx"</span> <span class="attribute">password</span>=<span class="value">"xxx"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">config</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-24-sauce-ondemandshi-yong" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/24/2012-04-24-sauce-ondemandshi-yong/" class="article-date">
  	<time datetime="2012-04-24T13:37:00.000Z" itemprop="datePublished">2012-04-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/24/2012-04-24-sauce-ondemandshi-yong/">Sauce OnDemand试用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>闲着无聊，试用了下<a href="https://saucelabs.com" target="_blank" rel="external">saucelabs</a>。<br>先注册用户，这个略过不说。</p>
<p>saucelabs有两种方式:</p>
<ol>
<li><p>Sauce Scout</p>
<p> 通过访问架在云端的浏览器(cloud-hosted browsers)执行测试用例。相当于saucelabs给用户提供了多种多样组合的虚拟机，只不过这个虚拟机就只有一个浏览器。如图：<br> <img src="/photos/soucescout.png" alt="sourcescout" title="soucescout"></p>
<p> Saucelabs提供了许多方案，对于那些没有空间部署环境的公司，这个服务的确很贴心。</p>
</li>
<li><p>Sauce OnDemand</p>
<p> Sauce OnDemand就是所谓的自动化了。我们利用WebDriver或者Selenium RC的remote server来指定SauceLabs提供的浏览器配置，进行各种自动化测试。</p>
</li>
</ol>
<p>那我们开始试用Sauce OnDemand，英语好的攻城狮们请直接移步<a href="https://saucelabs.com/docs/ondemand/getting-started/env/ruby/se2/linux" target="_blank" rel="external">Get Started</a></p>
<p>为了方便起见，我就用ruby。首先确保你安装了<code>selenium-webdriver</code>，如果没有安装，在终端用以下命令安装：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="keyword">install</span> selenium-webdriver</span><br></pre></td></tr></table></figure></p>
<p>输入以下代码：注意: 代码中的:url请替换成你自己的，不过我不知道这个url到底是哪里来的，<br>我是从get started里面的例子里找到的。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'rubygems'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"test/unit"</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'selenium-webdriver'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="inheritance">&lt; <span class="parent">Test::Unit</span></span>::<span class="title">TestCase</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup</span></span></span><br><span class="line">        caps = <span class="constant">Selenium::WebDriver::Remote::Capabilities</span>.firefox</span><br><span class="line">        caps.version = <span class="string">"5"</span></span><br><span class="line">        caps.platform = <span class="symbol">:XP</span></span><br><span class="line">        caps[<span class="symbol">:name</span>] = <span class="string">"Testing Selenium 2 with Ruby on Sauce"</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">@driver</span> = <span class="constant">Selenium::WebDriver</span>.<span class="keyword">for</span>(</span><br><span class="line">          <span class="symbol">:remote</span>,</span><br><span class="line">          <span class="symbol">:url</span> =&gt; <span class="string">"http://lihuazhang:ba444e83-206c-4a9c-b008-4da920d7f852@ondemand.saucelabs.com:80/wd/hub"</span>,</span><br><span class="line">          <span class="symbol">:desired_capabilities</span> =&gt; caps)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sauce</span></span></span><br><span class="line">        <span class="variable">@driver</span>.navigate.to <span class="string">"http://saucelabs.com/test/guinea-pig"</span></span><br><span class="line">        assert <span class="variable">@driver</span>.title.<span class="keyword">include</span>?(<span class="string">"I am a page title - Sauce Labs"</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown</span></span></span><br><span class="line">        <span class="variable">@driver</span>.quit</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>运行<code>ruby basic-example.rb</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Run options: </span><br><span class="line"></span><br><span class="line"><span class="preprocessor"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">Finished tests in <span class="number">44.647462</span>s, <span class="number">0.0224</span> tests/s, <span class="number">0.0224</span> assertions/s.</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> tests, <span class="number">1</span> assertions, <span class="number">0</span> failures, <span class="number">0</span> errors, <span class="number">0</span> skips</span><br></pre></td></tr></table></figure>
<p>可以看到运行成功，我们再去sauce的<a href="https://saucelabs.com/account" target="_blank" rel="external">Account</a>页面里去看下运行的结果。</p>
<p><img src="/photos/souceaccount.png" alt="account"></p>
<p>可以看到页面里有video和log下载，打开log我们可以看到运行的录像，而log就记录了运行的信息。<br>此外，我们更可以点开测试用例，查看更多的细节。</p>
<p>但是一般我们测试环境都是内网，为了满足这个条件，Saucelabs提供一条通道叫Sauce Connect。</p>
<blockquote>
<p>Sauce Connect creates a secure and reliable tunnel from our cloud to your private network that can only be accessed by you. This eliminates the need to whitelist IPs, open any ports on your firewall or go through any changes in your tests.<br>Sauce Connect is not only for accessing private servers. If you want all of your test traffic to be secure and reliable, even the Selenium instructions you send to Sauce, you can use Sauce Connect for that too!</p>
</blockquote>
<h2 id="Get_Started_3A"><a href="#Get_Started_3A" class="headerlink" title="Get Started:"></a>Get Started:</h2><p>1.先下载<a href="https://saucelabs.com/downloads/Sauce-Connect-latest.zip" target="_blank" rel="external">Sauce Connect</a></p>
<p>2.解压然后运行<code>java -jar Sauce-Connect.jar lihuazhang ba444e83-206c-4a9c-b008-4da920d7f852</code></p>
<ol>
<li>确定tunnel start以后，接下去你就可以运行你的测试用例了。</li>
</ol>
<p>我们再来看下刚刚那个测试用例，让程序navigate.to到本地。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'rubygems'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"test/unit"</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'selenium-webdriver'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="inheritance">&lt; <span class="parent">Test::Unit</span></span>::<span class="title">TestCase</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup</span></span></span><br><span class="line">        caps = <span class="constant">Selenium::WebDriver::Remote::Capabilities</span>.firefox</span><br><span class="line">        caps.version = <span class="string">"5"</span></span><br><span class="line">        caps.platform = <span class="symbol">:XP</span></span><br><span class="line">        caps[<span class="symbol">:name</span>] = <span class="string">"Testing Selenium 2 with Ruby on Sauce"</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">@driver</span> = <span class="constant">Selenium::WebDriver</span>.<span class="keyword">for</span>(</span><br><span class="line">          <span class="symbol">:remote</span>,</span><br><span class="line">          <span class="symbol">:url</span> =&gt; <span class="string">"http://lihuazhang:ba444e83-206c-4a9c-b008-4da920d7f852@ondemand.saucelabs.com:80/wd/hub"</span>,</span><br><span class="line">          <span class="symbol">:desired_capabilities</span> =&gt; caps)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sauce</span></span></span><br><span class="line">        <span class="variable">@driver</span>.navigate.to <span class="string">"http://localhost:3000"</span> <span class="comment"># Set a local env.</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown</span></span></span><br><span class="line">        <span class="variable">@driver</span>.quit</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>再运行一遍，必然成功啊~</p>
<p>我们看下Sauce-Connect.jar的日志，可以看到这个tunnel起到了一个中转的作用。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">01</span>,<span class="number">184</span> - connection to Sauce Connect server closed</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">01</span>,<span class="number">927</span> - old keepalive timer shutting down</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">03</span>,<span class="number">923</span> - Successful handshake with Sauce Connect server</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">03</span>,<span class="number">927</span> - resending <span class="number">2</span> packets</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">04</span>:<span class="number">04</span>,<span class="number">078</span> - Tunnel host version: <span class="number">0.1</span><span class="number">.0</span>, remote endpoint ID: <span class="number">73</span>b1e202231b41a3802aab8785caf15f</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">002</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">003</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">19</span>,<span class="number">007</span> - Could not proxy /, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">145</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">147</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/favicon.ico</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">148</span> - Could not proxy /favicon.ico, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">589</span> - relative URL, constructing absolute from Host header</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">592</span> - <span class="keyword">using</span> constructed absolute URL: http:<span class="comment">//localhost:3000/favicon.ico</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">22</span>,<span class="number">594</span> - Could not proxy /favicon.ico, exception: java.net.ConnectException: Connection refused</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">23</span>,<span class="number">391</span> - GET http:<span class="comment">//feeds.bbci.co.uk/news/rss.xml?edition=int -&gt; 200 (2847ms)</span></span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">53</span>,<span class="number">084</span> - disconnected from Sauce Connect server</span><br><span class="line"><span class="number">2012</span>-<span class="number">04</span>-<span class="number">25</span> <span class="number">00</span>:<span class="number">05</span>:<span class="number">53</span>,<span class="number">085</span> - connection to Sauce Connect server closed</span><br></pre></td></tr></table></figure>
<p>同样的，我们可以在Account里面看到这个测试用例的运行细节，如图：</p>
<p><img src="/photos/sauce_detail1.png" alt="detail"></p>
<p><img src="/photos/sauce_detail2.png" alt="detail"></p>
<p>不错吧，有兴趣，自己动手试试。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-23-mysql5-qing-kong-rootmi-ma" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/23/2012-04-23-mysql5-qing-kong-rootmi-ma/" class="article-date">
  	<time datetime="2012-04-23T13:27:00.000Z" itemprop="datePublished">2012-04-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/23/2012-04-23-mysql5-qing-kong-rootmi-ma/">mysql5 清空root密码</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>最近在windows用mysql，在root上设置了密码，很不方便，于是就想去清空它，网上找了下教程，总结了下。肯定好用。</p>
<ul>
<li><p>停止MySQL的服务。 </p>
</li>
<li><p>用mysqld.exe –skip-grant-tables &amp; (会占用一个dos控制台窗口)</p>
</li>
<li><p>重新打开一个dos控制台窗口，进入mysql </p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot</span><br><span class="line">use mysql</span><br><span class="line">update user <span class="built_in">set</span> password=password(<span class="string">""</span>) <span class="built_in">where</span> user=<span class="string">'root'</span>;</span><br><span class="line">flush privileges；</span><br></pre></td></tr></table></figure>
<ul>
<li><p>关闭MySQL的控制台窗口，用正常模式启动Mysql </p>
</li>
<li><p>你可以用新的密码链接到Mysql了。 </p>
</li>
</ul>
<p>Note:</p>
<p>Please specify the defaults file when you find the above instructions do not have effects.</p>
<ul>
<li>用mysqld.exe –defaults-file=”C:\ProgramData\MySQL\MySQL Server 5.5\my.ini” –skip-grant-tables &amp; (会占用一个dos控制台窗口)</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/mysql/">mysql</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-21-webdriver-3-more-pageobjects" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/21/2012-04-21-webdriver-3-more-pageobjects/" class="article-date">
  	<time datetime="2012-04-21T02:36:00.000Z" itemprop="datePublished">2012-04-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/21/2012-04-21-webdriver-3-more-pageobjects/">WebDriver 3: more PageObjects - PageFactory</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在上篇中，大致介绍了PageObjects。其实为了对PageObjects更好的支持，webdriver中还有一个<br><a href="http://code.google.com/p/selenium/wiki/PageFactory" target="_blank" rel="external">PageFactory</a>的概念。</p>
<blockquote>
<p>There is a PageFactory in the support package that provides support for this pattern, and helps to remove some boiler-plate code from your Page Objects at the same time.</p>
</blockquote>
<p>来看下,上篇中的百度搜索例子, 用PageFactory该如何实现。</p>
<ul>
<li>首先修改BaiduIndexPage</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driver = driver;</span><br><span class="line">        driver.get(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@FindBy</span>(how = How.ID, using = <span class="string">"kw"</span>)</span><br><span class="line">    <span class="keyword">private</span> WebElement searchField;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// We continue using the element just as before</span></span><br><span class="line">        searchField.sendKeys(text);</span><br><span class="line">        searchField.submit();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到这里使用了注释@FindBy， 这是一个注释类，我们来看下它的定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="annotation">@interface</span> FindBy &#123;</span><br><span class="line">  <span class="function">How <span class="title">how</span><span class="params">()</span> <span class="keyword">default</span> How.ID</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">using</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">id</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">className</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">css</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">tagName</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">linkText</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">partialLinkText</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">String <span class="title">xpath</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以知道其实FindBy注释就是实现了<code>driver.findElement(By)</code>,用FindBy可以从无数findElement方法中解脱出来(如果你页面有很多元素的时候)。</p>
<ul>
<li>然后要用工厂模式生成BaiduIndexPage对象</li>
</ul>
<p>在SearchTest.java 里<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BaiduIndexPage home = PageFactory.initElements(driver, BaiduIndexPage.class);</span><br><span class="line"><span class="comment">// BaiduIndexPage home = new BaiduIndexPage(driver);</span></span><br></pre></td></tr></table></figure></p>
<p>将WebDriver实例和BaiduIndexPage.class传给initElements方法，该方法会更具反射生成BaiduIndexPage实例，必须注意的是，使用PageFactory，我们的页面对象必须有<br>一个带有WebDriver类型参数的构造方法。</p>
<blockquote>
<p>This method will attempt to instantiate the class given to it, preferably using a constructor<br>which takes a WebDriver instance as its only argument or falling back on a no-arg constructor.</p>
</blockquote>
<p>PageFactory基本需要关注的就是：</p>
<pre><code>1. Findby注释
2. PageFactory.initElements
</code></pre><p>我们继续改造，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driver = driver;</span><br><span class="line">        driver.get(url);</span><br><span class="line">        PageFactory.initElements(driver, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@FindBy</span>(how = How.ID, using = <span class="string">"kw"</span>)</span><br><span class="line">    <span class="keyword">private</span> WebElement searchField;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@FindBy</span>(how = How.ID, using = <span class="string">"lg"</span>)</span><br><span class="line">    <span class="keyword">private</span> WebElement logo;</span><br><span class="line">    </span><br><span class="line">    <span class="annotation">@FindBy</span>(how = How.CLASS_NAME, using = <span class="string">"s_btn"</span>)</span><br><span class="line">    <span class="keyword">private</span> WebElement baidYiXiauButton;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// We continue using the element just as before</span></span><br><span class="line">        searchField.sendKeys(text);</span><br><span class="line">        searchField.submit();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">idLogoDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> logo.isDisplayed();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasBaidYiXiauButton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baidYiXiauButton.isDisplayed();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们将<code>PageFactory.initElements(driver, this);</code>放在页面类的构造函数里，这样就不需要将PageFactory暴露到TestCase中去。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchResultPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 推广链接所在位置 */</span></span><br><span class="line">    <span class="annotation">@FindBy</span>(how=How.ID, using=<span class="string">"ec_im_container"</span>)</span><br><span class="line">    <span class="keyword">private</span> WebElement adDiv;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SearchResultPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driver = driver;</span><br><span class="line">        PageFactory.initElements(driver, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> driver.getTitle();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> driver.getPageSource();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAdDivDisplayed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> adDiv.isDisplayed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面是测试用例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ahchoo.automation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertTrue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ahchoo.automation.page.BaiduIndexPage;</span><br><span class="line"><span class="keyword">import</span> com.ahchoo.automation.page.SearchResultPage;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Unit test for simple App.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        BaiduIndexPage home = <span class="keyword">new</span> BaiduIndexPage(driver);</span><br><span class="line">        assertTrue(home.hasBaidYiXiauButton());</span><br><span class="line">        assertTrue(home.idLogoDisplay());</span><br><span class="line">        SearchResultPage searchResult = home.searchFor(<span class="string">"pizza"</span>);</span><br><span class="line">        assertTrue(searchResult.isAdDivDisplayed());</span><br><span class="line">        assertTrue(searchResult.getTitle().contains(<span class="string">"pizza"</span>));</span><br><span class="line">        assertTrue(searchResult.getContent().contains(<span class="string">"pizza"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改造完毕，我可以保证这个Testcase能运行的很欢。</p>
<p>######总结<br>可以看到使用PageFactory可以使页面类代码更加清晰，维护也相对简单许多。如果你也使用PageObjects的话，<br>不妨试试看。如果你想多了解PageFactory的话，请移步<a href="http://code.google.com/p/selenium/wiki/PageFactor" target="_blank" rel="external">PageFactory</a>，<br>一定能让你受益匪浅。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-20-webdriver2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/20/2012-04-20-webdriver2/" class="article-date">
  	<time datetime="2012-04-20T11:07:00.000Z" itemprop="datePublished">2012-04-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/20/2012-04-20-webdriver2/">WebDriver 2: PageObject</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在上篇中，已经搭建好了环境。假设我们已经有这样一个环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">── pom.xml</span><br><span class="line">── src</span><br><span class="line">   ├── main</span><br><span class="line">   │   └── java</span><br><span class="line">   │       └── com</span><br><span class="line">   │           └── ahchoo</span><br><span class="line">   │               └── automation</span><br><span class="line">   │                   └── App.java</span><br><span class="line">   └── <span class="built_in">test</span></span><br><span class="line">       └── java</span><br><span class="line">           └── com</span><br><span class="line">               └── ahchoo</span><br><span class="line">                   └── automation</span><br><span class="line">                       └── AppTest.java</span><br></pre></td></tr></table></figure>
<p>在这个基础上，我们要实现一个访问百度，查询一个关键字之后，跳转到结果界面。</p>
<ul>
<li>开始之前，我们先想想传统的WebDriver代码应该怎么写？</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ahchoo.automation;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver.get(<span class="string">"http://www.baidu.com"</span>);</span><br><span class="line">        WebElement input = driver.findElement(By.id(<span class="string">"kw"</span>));</span><br><span class="line">        input.clear();</span><br><span class="line">        input.sendKeys(<span class="string">"Pizza"</span>);</span><br><span class="line">        input.submit();</span><br><span class="line">        assertTrue(driver.getTitle().contains(<span class="string">"Pizza"</span>));</span><br><span class="line">        assertTrue(driver.getContent().contains(<span class="string">"Pizza"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果只有一个测试用例，这样写也很清爽，但是如果有许许多多这样的测试用例，如果input的id发生变化了，就要把<br>所有的用到这个input的用例找出来，一一修改，这无疑是个大工程。</p>
<ul>
<li><p>让我们再来看看PageObjects，首先，我们要创建页面对象， 整个过程涉及2个页面</p>
<ol>
<li>百度首页</li>
<li>search结果页</li>
</ol>
</li>
</ul>
<p>所以我们也就有两个pageobjects， 将pageobjects class放在main source下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driver = driver;</span><br><span class="line">        driver.get(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String term)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Baidu search input id is "kw"</span></span><br><span class="line">        WebElement searchField = driver.findElement(By.id(<span class="string">"kw"</span>));</span><br><span class="line">        searchField.clear();</span><br><span class="line">        searchField.sendKeys(term);</span><br><span class="line">        searchField.submit();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchResultPage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SearchResultPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.driver = driver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> driver.getTitle();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> driver.getPageSource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>接着创建testcase，把测试用例放在test source目录下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ahchoo.automation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ahchoo.automation.page.BaiduIndexPage;</span><br><span class="line"><span class="keyword">import</span> com.ahchoo.automation.page.SearchResultPage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> WebDriver driver;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        BaiduIndexPage home = <span class="keyword">new</span> BaiduIndexPage(driver);</span><br><span class="line">        SearchResultPage searchResult = home.searchFor(<span class="string">"pizza"</span>);</span><br><span class="line">        assertTrue(searchResult.getTitle().contains(<span class="string">"pizza"</span>));</span><br><span class="line">        assertTrue(searchResult.getContent().contains(<span class="string">"pizza"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们运行下看看</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">➜  ahcoo  mvn test</span><br><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO]                                                                         </span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Building ahcoo <span class="number">1.0</span>-SNAPSHOT</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-resources-<span class="string">plugin:</span><span class="number">2.4</span><span class="number">.3</span>:resources (<span class="keyword">default</span>-resources) @ ahcoo ---</span><br><span class="line">[WARNING] Using platform encoding (EUC_CN actually) to copy filtered resources, i.e. build is platform dependent!</span><br><span class="line">[INFO] skip non existing resourceDirectory <span class="regexp">/Volumes/</span>MacBackUp<span class="regexp">/ahcoo/</span>src<span class="regexp">/main/</span>resources</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-compiler-<span class="string">plugin:</span><span class="number">2.3</span><span class="number">.2</span>:compile (<span class="keyword">default</span>-compile) @ ahcoo ---</span><br><span class="line">[INFO] Nothing to compile - all classes are up to date</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-resources-<span class="string">plugin:</span><span class="number">2.4</span><span class="number">.3</span>:testResources (<span class="keyword">default</span>-testResources) @ ahcoo ---</span><br><span class="line">[WARNING] Using platform encoding (EUC_CN actually) to copy filtered resources, i.e. build is platform dependent!</span><br><span class="line">[INFO] skip non existing resourceDirectory <span class="regexp">/Volumes/</span>MacBackUp<span class="regexp">/ahcoo/</span>src<span class="regexp">/test/</span>resources</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-compiler-<span class="string">plugin:</span><span class="number">2.3</span><span class="number">.2</span>:testCompile (<span class="keyword">default</span>-testCompile) @ ahcoo ---</span><br><span class="line">[INFO] Nothing to compile - all classes are up to date</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-surefire-<span class="string">plugin:</span><span class="number">2.7</span><span class="number">.2</span>:test (<span class="keyword">default</span>-test) @ ahcoo ---</span><br><span class="line">[INFO] Surefire report <span class="string">directory:</span> <span class="regexp">/Volumes/</span>MacBackUp<span class="regexp">/ahcoo/</span>target/surefire-reports</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"> T E S T S</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">Running com.ahchoo.automation.SearchTest</span><br><span class="line">Tests <span class="string">run:</span> <span class="number">1</span>, <span class="string">Failures:</span> <span class="number">0</span>, <span class="string">Errors:</span> <span class="number">0</span>, <span class="string">Skipped:</span> <span class="number">0</span>, Time <span class="string">elapsed:</span> <span class="number">21.474</span> sec</span><br><span class="line"></span><br><span class="line"><span class="string">Results :</span></span><br><span class="line"></span><br><span class="line">Tests <span class="string">run:</span> <span class="number">1</span>, <span class="string">Failures:</span> <span class="number">0</span>, <span class="string">Errors:</span> <span class="number">0</span>, <span class="string">Skipped:</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="string">time:</span> <span class="number">25.953</span>s</span><br><span class="line">[INFO] Finished <span class="string">at:</span> Fri Apr <span class="number">20</span> <span class="number">21</span>:<span class="number">53</span>:<span class="number">03</span> CST <span class="number">2012</span></span><br><span class="line">[INFO] Final <span class="string">Memory:</span> <span class="number">5</span>M/<span class="number">81</span>M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>
<p>Pass！</p>
<p>这就是当下流行的pageobjects，将页面固有的属性和逻辑抽象成类。然后在测试代码里面调用，这样有一个很大的好处，<br>如果页面变动了，只需要变动页面对象，不需要去无数测试用例里去寻找并更改。</p>
<p><blockquote></blockquote></p>
<p></p><p>Within your web app’s UI there are areas that your tests interact with. A Page Object simply models these as objects within the test code. This reduces the amount of duplicated code and means that if the UI changes, the fix need only be applied in one place.<br></p><br><small><br> simon.m.stewart  <a href="http://code.google.com/p/selenium/wiki/PageObjects" target="_blank" rel="external">PageObject</a><br></small><br><p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/" class="article-date">
  	<time datetime="2012-04-19T13:13:00.000Z" itemprop="datePublished">2012-04-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/">使用 Capybara， Cucumber 和 WebDriver 实现自动化测试</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我面试的时候，BOSS对我说，我们是要求自动化的。我想这我会啊。BOSS又说，我们也有一套自动化的框架。我想那更好。然后等我入职之后，发现毛框架也没有，只有四个完全不会代码的测试攻城狮。</p>
<p>老板说要自动化，我说自动化啊？我花了几天的时间温习了我熟悉的<code>JAVA+Junit+SeleniumRC</code>，否定了这个框架，一来语言太重，二来都不会coding。我很苦恼地向BOSS抱怨了，他说用脚本语言吧，于是我就想要不就用<code>python+pyunit+webdriver</code>，在google打工的时候，接触的就是这个框架。BOSS想了想，说用ruby吧。原因在他是ruby的超级粉丝。</p>
<p>于是我找到了<code>cucumber+capybara+webdriver</code>，这也是我第一次接触ruby，第一次接触BDD。而我选用这个框架的原因如下：</p>
<pre><code>1. cucumber有一套自己的DSL，任何会写测试用例的人都会写。
2. 对于这套框架要学的ruby知识，学起来相对容易。
3. 公司文化。
</code></pre><p>前面都是废话，下面开始进入正题。</p>
<p>##功于善其事，必先利其器</p>
<ul>
<li>首先搭建环境，确定有ruby的环境。安装必要的gem<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem install cucumber </span><br><span class="line">gem install capybara</span><br><span class="line">gem ins tall selenium-webdriver</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em><a href="http://cukes.info/" target="_blank" rel="external">Cucumber</a> <a href="https://github.com/jnicklas/capybara" target="_blank" rel="external">Capybara</a> <a href="http://code.google.com/p/selenium/" target="_blank" rel="external">WebDriver</a></em></p>
<ul>
<li>建立个空项目，将gem加入gemfile</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source <span class="string">"http://ruby.taobao.org/"</span></span><br><span class="line">gem <span class="string">'cucumber'</span>, <span class="string">'&gt;= 1.1.9'</span></span><br><span class="line">gem <span class="string">"capybara"</span>, <span class="string">"~&gt; 1.1.2"</span></span><br><span class="line">gem <span class="string">'selenium-webdriver'</span>, <span class="string">'&gt;= 2.20.0'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>先简单介绍一下cucumber</li>
</ul>
<p>我们在这个空项目下运行<code>cucumber</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ cucumber</span><br><span class="line">You don<span class="string">'t have a '</span>features<span class="string">' directory.  Please create one to get started.</span><br><span class="line">See http://cukes.info/ for more information.</span></span><br></pre></td></tr></table></figure>
<p>可以看出cucumber会去寻找<code>features</code>目录，先创建一个features目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ mkdir features</span><br><span class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ ls</span><br><span class="line">features</span><br><span class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ cucumber</span><br><span class="line"><span class="number">0</span> scenarios</span><br><span class="line"><span class="number">0</span> steps</span><br><span class="line"><span class="number">0</span>m0.<span class="number">000</span>s</span><br></pre></td></tr></table></figure>
<p>因为在features下面什么都没有，所以运行结果都是零。</p>
<p>那我们创建一个feature，cucumber把feature都命名为xxx.feature, 而每个feature有多个scenario。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">Feature</span><span class="symbol">:</span> <span class="constant">Adding</span></span><br><span class="line"></span><br><span class="line">    <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Add</span> two numbers</span><br><span class="line">        <span class="constant">Given</span> the input <span class="string">"2+2"</span></span><br><span class="line">        <span class="constant">When</span> the calculator is run</span><br><span class="line">        <span class="constant">Then</span> the output should be <span class="string">"4"</span></span><br><span class="line">    <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Minus</span> two numbers</span><br><span class="line">        <span class="constant">Given</span> the input <span class="string">"2-1"</span></span><br><span class="line">        <span class="constant">When</span> the calculator is run</span><br><span class="line">        <span class="constant">Then</span> the output should be <span class="string">"0"</span></span><br></pre></td></tr></table></figure>
<p>cucumber使用<code>Given/When/Then</code>这种叫做<a href="https://github.com/cucumber/cucumber/wiki/Gherkin" target="_blank" rel="external">gherkin</a>的可描述性语言(DSL)。</p>
<p>feature文件中的每个Given/When/Then步骤在Step文件中都有对应的Ruby执行代码，两类文件通过正则表达式相关联。后面马上讲到。</p>
<p>让我们再来运行一遍</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">zhangmatoMacBook-<span class="constant">Pro</span><span class="symbol">:test</span> lihuazhang<span class="variable">$ </span>cucumber </span><br><span class="line"><span class="constant">Feature</span><span class="symbol">:</span> <span class="constant">Adding</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Add</span> two numbers       <span class="comment"># features/test.feature:3</span></span><br><span class="line">    <span class="constant">Given</span> the input <span class="string">"2+2"</span>         <span class="comment"># features/test.feature:4</span></span><br><span class="line">    <span class="constant">When</span> the calculator is run    <span class="comment"># features/test.feature:5</span></span><br><span class="line">    <span class="constant">Then</span> the output should be <span class="string">"4"</span> <span class="comment"># features/test.feature:6</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Minus</span> two numbers     <span class="comment"># features/test.feature:7</span></span><br><span class="line">    <span class="constant">Given</span> the input <span class="string">"2-1"</span>         <span class="comment"># features/test.feature:8</span></span><br><span class="line">    <span class="constant">When</span> the calculator is run    <span class="comment"># features/test.feature:9</span></span><br><span class="line">    <span class="constant">Then</span> the output should be <span class="string">"0"</span> <span class="comment"># features/test.feature:10</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> scenarios (<span class="number">2</span> undefined)</span><br><span class="line"><span class="number">6</span> steps (<span class="number">6</span> undefined)</span><br><span class="line">0m<span class="number">0</span>.<span class="number">005</span>s</span><br><span class="line"></span><br><span class="line"><span class="constant">You</span> can implement step definitions <span class="keyword">for</span> undefined steps with these <span class="symbol">snippets:</span></span><br><span class="line"></span><br><span class="line"><span class="constant">Given</span> /^the input <span class="string">"([^"</span>]*)<span class="string">"$/ do |arg1|</span><br><span class="line">  pending # express the regexp above with the code you wish you had</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">When /^the calculator is run$/ do</span><br><span class="line">  pending # express the regexp above with the code you wish you had</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Then /^the output should be "</span>([^<span class="string">"]*)"</span><span class="variable">$/</span> <span class="keyword">do</span> |arg1|</span><br><span class="line">  pending <span class="comment"># express the regexp above with the code you wish you had</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">If</span> you want snippets <span class="keyword">in</span> a different programming language,</span><br><span class="line">just make sure a file with the appropriate file extension</span><br><span class="line">exists where cucumber looks <span class="keyword">for</span> step definitions.</span><br></pre></td></tr></table></figure>
<p>可以看到我们运行了2个scenarios,6个steps，都没有定义，于是cucumber仁慈的告诉了我们如何实现。于是我们就要开始写step了。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#小小作弊下，就不写的漂亮了。</span></span><br><span class="line"><span class="constant">Given</span> /^the input <span class="string">"([^"</span>]*)<span class="string">"$/ do |statement|</span><br><span class="line">    @answer = eval statement</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">When /^the calculator is run$/ do</span><br><span class="line">    puts "</span><span class="constant">Run</span>~<span class="string">"</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Then /^the output should be "</span>([^<span class="string">"]*)"</span><span class="variable">$/</span> <span class="keyword">do</span> |answer|</span><br><span class="line">    <span class="variable">@answer</span> == answer</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>我们再来运行一遍</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">zhangmatoMacBook-<span class="constant">Pro</span><span class="symbol">:test</span> lihuazhang<span class="variable">$ </span>cucumber </span><br><span class="line"><span class="constant">Feature</span><span class="symbol">:</span> <span class="constant">Adding</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Add</span> two numbers       <span class="comment"># features/test.feature:3</span></span><br><span class="line">    <span class="constant">Given</span> the input <span class="string">"2+2"</span>         <span class="comment"># features/step_definitions/test_step.rb:1</span></span><br><span class="line">    <span class="constant">When</span> the calculator is run    <span class="comment"># features/step_definitions/test_step.rb:5</span></span><br><span class="line">      <span class="constant">Run</span>~</span><br><span class="line">    <span class="constant">Then</span> the output should be <span class="string">"4"</span> <span class="comment"># features/step_definitions/test_step.rb:9</span></span><br><span class="line"></span><br><span class="line">  <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Minus</span> two numbers     <span class="comment"># features/test.feature:7</span></span><br><span class="line">    <span class="constant">Given</span> the input <span class="string">"2-1"</span>         <span class="comment"># features/step_definitions/test_step.rb:1</span></span><br><span class="line">    <span class="constant">When</span> the calculator is run    <span class="comment"># features/step_definitions/test_step.rb:5</span></span><br><span class="line">      <span class="constant">Run</span>~</span><br><span class="line">    <span class="constant">Then</span> the output should be <span class="string">"0"</span> <span class="comment"># features/step_definitions/test_step.rb:9</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> scenarios (<span class="number">2</span> passed)</span><br><span class="line"><span class="number">6</span> steps (<span class="number">6</span> passed)</span><br><span class="line">0m<span class="number">0</span>.<span class="number">005</span>s</span><br></pre></td></tr></table></figure>
<p>哇，恭喜都通过了。</p>
<p>好，关于cucumber的介绍就到这里，具体可以去看看<a href="http://www.cnblogs.com/CloudTeng/articles/2214293.html" target="_blank" rel="external">Cucumber的目录结构和执行过程</a></p>
<ul>
<li>在简单介绍下Capybara</li>
</ul>
<p>Capybara是水豚的意思，在水豚之前有一个老鼠，叫做webrat，你如果在google上搜索<code>capybara webrat</code>的话，会发现一大推类似</p>
<blockquote><br>Cucumber: Switching from Webrat to Capybara - cakebaker<br>cakebaker.42dh.com/…/cucumber-switching-from… - 网页快照 - 翻译此页<br>19 Sep 2010 – Fortunately, there is an alternative working with both Rails versions: Capybara. And so I decided to make the switch from Webrat to Capybara.<br></blockquote>

<p>Webrat逐渐被Capybara取代，就像selenium逐渐被webdriver取代。</p>
<p>Capybara主要是用来测试rails和Rack应用的。官网上说</p>
<blockquote><br>Capybara helps you test Rails and Rack applications by simulating how a real user would interact with your app. It is agnostic about the driver running your tests and comes with Rack::Test and Selenium support built in. WebKit is supported through an external gem.<br></blockquote>

<p>我们主要用Capybara和Webdriver结合起来进行网页自动化测试。（注意：Capybara不支持selenium rc）</p>
<p>详细请见<a href="https://github.com/jnicklas/capybara" target="_blank" rel="external">Capybara</a>,里面讲的非常详细了。</p>
<p>##小试牛刀<br>在了解了cucumber和capybara之后，我们可以正式开始写点东西。 在空项目底下，建立类似的目录结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">├── features</span><br><span class="line">    ├── example</span><br><span class="line">       ├── example.feature</span><br><span class="line">       ├── step_definitions</span><br><span class="line">       │   └── example_steps.rb</span><br><span class="line">       └── support</span><br><span class="line">           └── env.rb</span><br></pre></td></tr></table></figure>
<p>我们这个例子是访问百度</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="constant">Feature</span><span class="symbol">:</span> <span class="constant">Using</span> baidu</span><br><span class="line"></span><br><span class="line"><span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Searching</span> <span class="keyword">for</span> a term</span><br><span class="line"></span><br><span class="line"><span class="constant">Given</span> <span class="constant">I</span> am on baidu.com</span><br><span class="line"><span class="constant">When</span> <span class="constant">I</span> enter <span class="string">"pizza"</span></span><br><span class="line"><span class="constant">And</span> <span class="constant">I</span> press <span class="string">"百度一下"</span></span><br><span class="line"><span class="constant">Then</span> <span class="constant">I</span> should see <span class="string">"pizza_百度百科"</span></span><br></pre></td></tr></table></figure>
<p>Given/When/And/Then很明了的告诉我们，打开百度，输入pizza，然后点击百度一下，然后就能看到pizza_百度百科。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">Given</span> /^<span class="constant">I</span> am on baidu\.com<span class="variable">$/</span> <span class="keyword">do</span></span><br><span class="line">  <span class="constant">Capybara</span>.app_host = <span class="string">"http://www.baidu.com"</span></span><br><span class="line">  visit(<span class="string">'/'</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">When</span> /^<span class="constant">I</span> enter <span class="string">"([^"</span>]*)<span class="string">"$/ do |term|</span><br><span class="line">  fill_in('wd',:with =&gt; term)</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">When /^(?:|I )press "</span>([^<span class="string">"]*)"</span><span class="variable">$/</span> <span class="keyword">do</span> |button|</span><br><span class="line">  puts button</span><br><span class="line">  click_button(button)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="constant">Then</span> /^(?<span class="symbol">:|I</span> )should see <span class="string">"([^"</span>]*)<span class="string">"$/ do |text|</span><br><span class="line">  if page.respond_to? :should</span><br><span class="line">    page.should have_content(text)</span><br><span class="line">  else</span><br><span class="line">    assert page.has_content?(text)</span><br><span class="line">  end</span><br><span class="line">end</span></span><br></pre></td></tr></table></figure>
<p>接着就是值得一提的env.rb，这是cucumber的环境配置文件。</p>
<blockquote><br>The file features/support/env.rb is always the very first file to be loaded when Cucumber starts a test run. You use it to prepare the environment for the rest of your support and step definition code to operate.<br></blockquote>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'capybara'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'capybara/cucumber'</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'capybara/dsl'</span></span><br><span class="line"></span><br><span class="line"><span class="constant">Capybara</span>.app_host = <span class="string">"http://www.baidu.com"</span></span><br><span class="line"><span class="constant">Capybara</span>.default_driver = <span class="symbol">:selenium</span></span><br></pre></td></tr></table></figure>
<p>让我们来运行一下</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">zhangmatoMacBook-<span class="constant">Pro</span><span class="symbol">:features</span> lihuazhang<span class="variable">$ </span>cucumber example/example.feature </span><br><span class="line"><span class="constant">Feature</span><span class="symbol">:</span> <span class="constant">Using</span> baidu</span><br><span class="line"></span><br><span class="line">  <span class="constant">Scenario</span><span class="symbol">:</span> <span class="constant">Searching</span> <span class="keyword">for</span> a term   <span class="comment"># example/example.feature:4</span></span><br><span class="line">    <span class="constant">Given</span> <span class="constant">I</span> am on baidu.com        <span class="comment"># example/step_definitions/example_steps.rb:1</span></span><br><span class="line">    <span class="constant">When</span> <span class="constant">I</span> enter <span class="string">"pizza"</span>           <span class="comment"># example/step_definitions/example_steps.rb:6</span></span><br><span class="line">    <span class="constant">And</span> <span class="constant">I</span> press <span class="string">"百度一下"</span>             <span class="comment"># example/step_definitions/example_steps.rb:10</span></span><br><span class="line">      百度一下</span><br><span class="line">    <span class="constant">Then</span> <span class="constant">I</span> should see <span class="string">"pizza_百度百科"</span> <span class="comment"># example/step_definitions/example_steps.rb:15</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> scenario (<span class="number">1</span> passed)</span><br><span class="line"><span class="number">4</span> steps (<span class="number">4</span> passed)</span><br><span class="line">0m9.<span class="number">184</span>s</span><br></pre></td></tr></table></figure>
<p>Nice!</p>
<p>至此，基本的框架搭好了。至于如何配置不同的浏览器，以及如何和page object配合，我们以后再讲。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/capybara/">Capybara</a>
	</div>


      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/capybara/">capybara</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cucumber/">cucumber</a></li></ul>
	</div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
    <article id="post-2012-04-06-webdriver-1-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/06/2012-04-06-webdriver-1-post/" class="article-date">
  	<time datetime="2012-04-06T10:18:00.000Z" itemprop="datePublished">2012-04-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/06/2012-04-06-webdriver-1-post/">WebDriver 1: Set up WebDriver using Maven3</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><br></p><h3>1. Learn Maven3 first.</h3><br>  This is quite simple. Go through <a href="http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html" target="_blank" rel="external">Maven in 5 Minutes</a><br>  That’s quite enough.<br><p></p>

<p><br></p><h3>2. Set up project</h3><br>Using the command in Maven in 5 Minutes to create a project using your own groupId and artifactId.<br><pre class="prettyprint"><br>mvn archetype:generate -DgroupId=com.ahchoo.automation -DartifactId=ahcoo -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false<br></pre><br><p></p>

<p><br>Change the pom.xml to add Junit and WebDriver dependencies<br><pre class="prettyprint"><br>&lt;project&gt;<br>…<br>    &lt;dependencies&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;junit&lt;/groupId&gt;<br>            &lt;artifactId&gt;junit&lt;/artifactId&gt;<br>            &lt;version&gt;4.10&lt;/version&gt;<br>            &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;<br>            &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;<br>            &lt;version&gt;2.20.0&lt;/version&gt;<br>            &lt;/dependency&gt;<br>            &lt;/dependencies&gt;&lt;/scope&gt;&lt;/version&gt;&lt;/artifactId&gt;&lt;/groupId&gt;<br>        &lt;/dependency&gt;<br>    &lt;/dependencies&gt;<br>…<br>&lt;/project&gt;<br></pre><br>Then run <code class="cmd">mvn clean install</code><br></p>

<p><br></p><h3>3. Using eclipse to import this project</h3><br>install <a href="http://eclipse.org/m2e/" target="_blank" rel="external">m2eclipse</a> and<br>run command in the project root directory:<br><pre class="prettyprint"><br>mvn eclipse:clean<br>mvn eclipse:eclipse<br></pre><br><br>open eclise, click File and choose Import:<br><p><br>    <img src="/photos/1.png"><br></p><br>Choose Existing Projects into Workspace<br><p><br>    <img src="/photos/2.png"><br></p>

<p>After import, you will see the file tree in eclipse project explorer:</p>
<p><br><img src="/photos/3.png"><br></p><br><p></p>

<p>Thus the environment is set up.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/webdriver/">WebDriver</a>
	</div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
    


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2016 恒温
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >本站到访数: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, 本页阅读量: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    
	<script>
		var yiliaConfig = {
			fancybox: false,
			mathjax: true,
			animate: true,
			isHome: true,
			isPost: false,
			isArchive: false,
			isTag: false,
			isCategory: false,
			open_in_new: false
		}
	</script>


<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#top" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>